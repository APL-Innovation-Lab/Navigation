function camelize(t){return t.replace(/(?:^|[-_])(\w)/g,function(t,e){return e?e.toUpperCase():""})}function close_popover_on_outer_click(t){var e=Math.floor(1e6*Math.random());t.on("shown.bs.popover",function(){$(document).on("click.close_popover_on_outer_click"+e,function(e){var i=$(e.target);i&&0===i.parents(".popover").length&&t.popover("destroy")})}),t.on("hide.bs.popover",function(){$(document).off("click.close_popover_on_outer_click"+e)})}function is_responsive_page(){return $("body").hasClass("lt_responsive")}function responsive_feature_enabled(t){var e=["holds","checked_out","recently_returned","account_messages"];return navigator.userAgent.toLowerCase().match(/ipad/)&&-1!==e.indexOf(t)?!0:bc_feature["Responsive"+camelize(t)]||BC_USER_ID>0&&"true"===$.cookie("opt_in_feature_"+t)}function digital_modal_callback(){function t(t,e){$(".digital_formats").on("click",t,function(){$(e).find(t).removeClass("selected"),$(this).addClass("selected"),$(this).find("input[type=radio]").prop("checked",!0);var i=$(this).parents(bc_datajs_selector("digital_download_no_format"));i.length>0&&i.submit()})}validate_jacket_image($.datajs("modal_bib_image").find("img"));var e={errorPlacement:function(t,e){t.insertAfter("digital_format"==e.attr("name")?".js_format_of_columns":"digital_duration"==e.attr("name")?".digital_durations":e)}};$("#digital_hold_form").validate(e),$("#digital_checkout_form").validate(e),t(bc_datajs_selector("selected_format_hook"),".js_format_of_columns"),t(bc_datajs_selector("selected_duration_hook"),".digital_durations"),$(".digital_formats").on("click",bc_datajs_selector("selected_format_hook"),function(){$(".digital_durations").find("li").addClass("disabled"),$(".digital_durations").find("li").removeClass("selected"),$(".digital_durations").find("input.duration").attr("disabled","disabled"),$(".digital_durations").find("input:checked").attr("checked",!1);var t=$(this).find(".js_format_hook").attr("value").toLowerCase(),e=$(".digital_durations").find("."+t+"_format");e.removeClass("disabled"),e.find("input").removeAttr("disabled")})}function carousel_filter(t,e,i,n,o){e.on("change",function(){var s=e.closest("form"),a=s.find("select, input#f_on_order").not('select[value*="any"]').serialize(),r=s.find('input[name="bib"]').attr("value");$.cookie("back_to",baseURL()+document.location.pathname+"?view=VIEWCOVERS&bib="+r+"&format_html=true",{path:"/"}),e.attr("disabled","disabled"),$.getJSON(baseURL()+"/"+i+"/"+n+"?view=VIEWCOVERS&bib="+r+"&"+a,function(i){e.removeAttr("disabled");try{t.html(i.html),BCSlider.carouselImageCheck(null,t)}catch(n){o.destroySlider()}-1===i.html.indexOf("no_items")?o.reloadSlider():o.destroySlider()})})}function get_holds_button_url(t){var e=t.attr("href"),i=t.parents(bc_datajs_selector("hold_button_container"));if(i.length){var n=t[0].search?$.deparam.querystring(e):{};n.hold_button_bundle=i.data("bundle"),e=e.split("?")[0]+"?"+$.param(n)}return e}function activate_main_nav(){var t=window.location.pathname+window.location.search;$("#mainNav").find("a[href='"+t+"']").parent("a.navLabel").addClass("active")}function digital_modal_form_callback(t){t.drm_requested&&($.modal("show",{content:t.html}),$(".checkout_drm_requested").on("click",function(){$(this).hide(),Messages.clear(),$("#drm_requested").find(".drm_attempted").show()}),$(".checkout_drm_done").on("click",function(t){t.preventDefault(),$.modal("hide",{}),Messages.clear()}))}function ajax_holds_callback(t){var e=this,i={forms_callback:function(t){if(t.close_popup)if("function"==typeof load_circulation_widget)load_circulation_widget();else{if(bc_feature.BootstrapPopovers?e.popover("destroy"):$.fn.popout("hide_content"),t.partials){var i=$(e).parents(bc_datajs_selector("hold-item"));if(0===i.length)var i=$(e).parents(".listItem");$.each(t.partials,function(t,e){i.find("."+t).replaceWith(e)})}$.datajs("missing_format_download").bc_inline_overlay({send_forms:!0,callback:digital_modal_callback,forms_callback:digital_modal_form_callback})}},modal_dialog:function(){t.overlay?e.overlay({remote:t.source_url,open_on_init:!0}):is_responsive_page()&&$(e).parents(".listItem").length>0?e.bc_inline_overlay({source_url:t.source_url,send_forms:!0,forms_callback:i.forms_callback,inline_messaging:!0,open_on_init:!0}):$.modal("show",{source_url:t.source_url,send_forms:!0,forms_callback:i.forms_callback})},setup:function(){t.source_url?i.modal_dialog():i.forms_callback(t)}};i.setup()}function hijack_modal_inits(){$("#hijack-modal, #hijack-modal-close").on("click",function(t){t.stopPropagation(),setTimeout(function(){$("#globalSpinner").removeClass("activeSpinner")},300),$("#hijack-modal").remove()})}function init_personal_info_page(){$.datajs("a","user_info_show").on("click",function(t){t.preventDefault();var e=$(this).closest($.datajs("user_account")).attr("id");$(this).hide(),$("#"+e).datajs("user_info_hide").show(),$("#"+e).datajs("info_toggle").slideDown()}),$.datajs("a","user_info_hide").on("click",function(t){t.preventDefault();var e=$(this).closest($.datajs("user_account")).attr("id");$(this).hide(),$("#"+e).datajs("user_info_show").show(),$("#"+e).datajs("info_toggle").slideUp()})}function load_availability_placeholder(){$.datajs("availability_placeholder").each(function(){var t=$(this);$.ajax({url:"/item/availability_info/",data:{id:t.data("bib-id")},show_spinner:!1,dataType:"json"}).then(function(e){t.replaceWith(e.html)})})}function modal_or_inline_overlay(t,e){var i=e.live_selector,n=is_responsive_page()&&(t.is(".listItem")||t.parents(".listItem").length>0);if(!n)return i?t.live_modal(i,e):t.modal(e);if(!i)return t.bc_inline_overlay(e);t.on("contentchange",e.live_modal,function(){$(this).bc_inline_overlay(e)});var o=t.find(i);return o.length>0?t.find(i).bc_inline_overlay(e):void 0}function tidyTitles(t){var e=t.split(" - "),i="<a href='javascript:void(0)' class='pull-right' data-js='close_button'><i class='icon-cancel'></i></a>";return e.length>1?(template=i+"<div style='width:250px;'><h3>__TITLE__</h3> __TEXT__</div>",template.replace("__TITLE__",e[0]).replace("__TEXT__",e[1])):(template=i+"<div style='width:200px;'>__TEXT__</div>",template.replace("__TEXT__",e[0]))}function obj_size(t){var e,i=0;for(e in t)t.hasOwnProperty(e)&&i++;return i}function validUsername(t){var e=new RegExp(/[a-zA-Z0-9\_]*/),i=new RegExp(/^\d+$/);return!i.test(t)&&e.test(t)}function init_video_embed(){var t=function(t){var e=/(http:\/\/www\.schooltube\.com\/embed_force\/[a-f|0-9]*)/,i=/(http:\/\/www\.teachertube\.com\/embed\.[a-z]*\?(pg|video_id)=[0-9|a-z|A-Z|\-|\_]*)/,n=/(\/\/www\.youtube\.com\/(v|embed)\/[0-9|a-z|A-Z|\-|\_]*)|(http:\/\/www\.youtube\.com\/watch\?v\=[0-9|a-z|A-Z|\-|\_]*)/;return n.test(t)?t=t.match(n)[0]:e.test(t)?t=t.match(e)[0]:i.test(t)&&(t=t.match(i)[0]),t};$(".popout-box").on("change",".video_embed_code",function(){embed_code=$(this),embed_code.val()&&embed_code.val(t.call(null,embed_code.val()))})}function trigger_j_callback(t,e,i){var n=$("#"+t);n.length>0&&($.removeCookie("j_callback",{path:"/"}),null!=i&&$.getJSON("/messages/create_message",{message:i}),e&&(window.location.href="#"+$("#"+t).attr("id")),is_responsive_page()&&$("html, body").animate({scrollTop:n.offset().top-window.innerHeight/2}),n.trigger("click"))}function get_largest(t,e){var i={key:null,val:null};for(var n in t)t[n]>i.val&&(i.key=n,i.val=t[n]);return e?i.val>=e?i:null:i}function fake_stringify(t){var e="";return $.each(t,function(t,i){e=e+""+t+"="+i+","}),e}function fake_parse(t){var e=t.split(","),i={};return $.each(e,function(t,e){if(e.length>0){var n=e.split("=");i[n[0]]=parseInt(n[1])}}),i}function tabs(){var t=$(this).attr("param"),e=$("#"+$(this).parent("div").attr("id").replace("viewSelector_",""));$(this).addClass("active").siblings().removeClass("active"),e.find('.tab[param="'+t+'"]').show().siblings().hide()}function baseURL(){var t=location.href,e=t.substring(0,t.indexOf("/",14));return e}function swap_action(t,e){var i=parseUri(t);return t=i.path||t,t=t.split("/"),swap_index=0==$.trim(t[0]).length?2:1,t[swap_index]=e,t=t.join("/")}function get_string(t){return BCLang[t]?$.trim(BCLang[t]):""}function parseUri(t){var e=t.match(/^(?:([^:\/?#.]+):)?(?:\/\/)?(([^:\/?#]*)(?::(\d*))?)((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[\?#]|$)))*\/?)?([^?#\/]*))?(?:\?([^#]*))?(?:#(.*))?/);return e?e.associate(["uri","scheme","authority","domain","port","path","directory","file","query","fragment"]):null}function custom_ils_error_popup(t){$.modal("show",{content:t,fixed_width:"500px",hide_overflow:!0})}function init_filters_expanders(){$(".popup_more").on("click",function(t){function e(t){if(is_responsive_page())i.overlay({content:t,css_effect:"instant",open_callback:function(){this.$container.find(".filterList").filterList(),$.datajs("pretty-checkbox").cp_pretty_checkbox(),$.datajs("drawer-trigger").cp_drawer("hide")}}),i.overlay("open");else{var e=$("#popout-box-content").html().replace(/(<([^>]+)>)/gi,""),o=bc_request_ajax_cache[n].replace(/(<([^>]+)>)/gi,"");(e!=o||0==$("#popout-box-content").is(":visible"))&&(i.popout({content:bc_request_ajax_cache[n],offset:i.outerWidth(!1)+13}),$(".filterList").filterList())}}t.preventDefault();var i=$(this),n=(i.parents(".filterList"),i.attr("href")),o=bc_request_ajax_cache[n];"string"!=typeof o?$.ajax({url:n,dataType:"json",success:function(t){var i=t.html.replace(/\n/g,"").replace(/\s/g," ").replace(/  ,/g," ");bc_request_ajax_cache[n]=i,e(i)}}):e(o)})}function is_mobile_device(){return/mobile|tablet|ip(ad|hone|od)|android|silk/i.test(navigator.userAgent)}function page_id(t){return t||(t=window.location.pathname),path_parts=t.split("/"),path_parts.length>=4?path_parts[3]:""}function page_action(t){return t||(t=window.location.pathname),path_parts=t.split("/"),path_parts.length>=2?path_parts[2]:""}function last_term(t){var e=t.split(/,\s*/);return e[e.length-1]}function split(t){return t.split(/,\s*/)}function frbr_match(t,e){e instanceof Array||(e=Array.prototype.slice.call(arguments,1)),$.getJSON("/bib/match/"+t).done(function(i){bc_request_ajax_cache.frbr_match=[t,i],$.each(e,function(e,n){n(t,i)})})}function elementIsVisible(t){"function"==typeof jQuery&&t instanceof jQuery&&(t=t[0]);var e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}function init_line_clamps(){$.datajs("line-clamp").each(function(){var t=$(this);if(""!==t.text().trim()){var e=parseInt(t.css("line-height")),i=parseInt(t.css("font-size")),n=parseInt(t.css("font-weight"));t.css("height",""),t.position().top+t.height()>t.parent().height()&&t.height(t.parent().height()-t.position().top);var o=t.data("truncation-text")||"...",s=t.width()/i,a=t.height()/e,r=Math.ceil(a)*e,l=e/i;n>500&&(l*=550/n);var d=Math.floor(a*s*l),c=t.data("text")||t.text().trim();t.data("text")||t.data("text",c);var p=c.substring(0,d).lastIndexOf(" "),h=c.substring(0,p>=0?p:d);t.height(r),t.text(h),c.length!==h.length&&t.append("<span>"+o+"</span>")}})}function auth_modal_close(){"undefined"!=typeof localStorage&&localStorage.removeItem("ecom_stored_product")}function get_bib_title(){if("undefined"!=typeof $){var t=$(".titleBlock > h1").text()||document.title.split("|")[0];return $.trim(t)}return document.title.split("|")[0]}function crossDomainAjax(t,e){var i=new jQuery.Deferred;if("XDomainRequest"in window&&null!==window.XDomainRequest){var n=new XDomainRequest;return n.open("get",t),n.onload=function(){var t=new ActiveXObject("Microsoft.XMLDOM"),o=$.parseJSON(n.responseText);t.async=!1,i.resolve(o),"function"==typeof e&&e(o)},n.onprogress=function(){},n.ontimeout=function(){},n.onerror=function(){i.reject(arguments)},setTimeout(function(){n.send()},0),i.promise()}return send_json_request(t,e)}function send_json_request(t,e){return $.getJSON(t,function(t){"function"==typeof e&&e(t)})}function debounce(t,e,i){var n;return function(){var o=this,s=arguments;clearTimeout(n),n=setTimeout(function(){n=null,i||t.apply(o,s)},e),i&&!n&&t.apply(o,s)}}function init_single_click_action_overlays(){$.datajs("single-click-list-action").off(".single-click-list-action").on("ajax:success.single-click-list-action",function(t,e){var i=$(this),n=$('<div class="col-xs-12"></div>').html(e.messages);i.parents(".listItem").prepend(n),setTimeout(window.location.reload.bind(window.location,!0),2e3)})}!function(t){bc_datajs_selector=function(t,e){return"undefined"==typeof e&&(e=t,t=""),t+"[data-js~="+e+"]"},t.fn.datajs=function(t,e){return this.find(bc_datajs_selector(t,e))},t.datajs=function(e,i){return t(bc_datajs_selector(e,i))}}(jQuery),function(t){var e,i,n,o,s,a={init:function(){return this.each(function(){e=t(this),i=e.find("select"),n=e.find("textarea"),o=n.attr("data-message"),s=e.find("input"),"default"==i.val()&&a.disable_form(),i.bind("keyup.inline_form",a.show_form).bind("change.inline_form",a.show_form),e.bind("submit.inline_form",a.submit_form),n.bind("keyup.inline_form",a.send_toggle)})},submit_form:function(i){i.preventDefault();var n=e.serialize(),o=e.attr("action");t.ajax({url:o,data:n,dataType:"json",success:function(){a.disable_form()}})},show_form:function(){var r=i.val();t("#lib_feedback_"+r+"_link").length?(e.children(".feedback_element").hide(),s.hide(),t("#lib_feedback_"+r+"_link").show()):n.parent("div:hidden")&&(e.children(".feedback_element").hide(),n.parent("div").show(),s.show()),"default"!=r?(n.val()==o&&n.val("").removeAttr("disabled"),a.send_toggle()):a.disable_form()},send_toggle:function(){n.val().length>0&&n.val()!=o?s.removeAttr("disabled"):s.attr("disabled","disabled")},disable_form:function(){n.val(o).attr("disabled","disabled"),a.send_toggle()}};t.fn.inline_form=function(t){return a[t]?a[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void 0:a.init.apply(this,arguments)}}(jQuery);var Messages=function(){var t=15e3,e=!1,i=function(t,e,i){return $("<p/>").addClass(i).attr("data-test-id","top-message").attr("data-message-type",e.toUpperCase()).html(t)};return{show:function(n){if(n&&n.length>0){Messages.clear(),e&&clearTimeout(e);for(var o=0;o<n.length;o++){var s=n[o],a=!1;if("object"==typeof s&&"undefined"!=typeof s.space)for(var r=s.space.length;r>=0&&!a;r--){for(var l=jQuery.makeArray(s.space.slice(0,r)),d=registered_messages.length-1;d>=0&&!a;d--)if(registered_messages[d].key.join("/")==l.join("/")&&jQuery.inArray(s.type,jQuery.makeArray(registered_messages[d].type))>-1&&$("#"+registered_messages[d].element).length>0){var c=$("#"+registered_messages[d].element).parent(".messageContent").parent(".messaging"),p=!0,h=c.parent(),p="none"!=h.css("display")&&"hidden"!=h.css("visibility");if(c.length>0&&p){var u=s.key?s.key:registered_messages[d].default_message,f=u.strip_scripts(),g=i(f,s.type,"message-text");$("#"+registered_messages[d].element).append(g),c.addClass("displayMessage"),c.addClass(s.type),a=!0}else"suppress"==registered_messages[d].mode&&(a=!0)}if(!a){var c=$(".top_message").parent(".messageContent").parent(".messaging"),p=!0,h=c.parent(),p="none"!=h.css("display")&&"hidden"!=h.css("visibility");if(c.length>0&&p){var u=s.key?s.key:registered_messages[d].default_message,f=u.strip_scripts(),g=i(f,s.type);$(".top_message").append(g),c.addClass("displayMessage"),c.addClass(s.type),a=!0}else"suppress"==registered_messages.mode&&(a=!0)}}}e=setTimeout(function(){Messages.clear()},t)}},clear:function(){for(var t=0;t<registered_messages.length;t++)if($("#"+registered_messages[t].element)&&$("#"+registered_messages[t].element).parent(".messageContent").parent(".messaging")){var e=$("#"+registered_messages[t].element);e.parent(".messageContent").parent(".messaging").removeClass("displayMessage error message warning info"),e.html("")}}}}();window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},BC_MESSAGE_TYPE_TO_BOOTSTRAP_MAP={info:"info",error:"danger",warning:"warning",message:"success"},BC_MESSAGE_TYPE_TO_ICON_MAP={info:"icon-info-circled",error:"icon-attention-circled",warning:"icon-attention",message:"icon-ok-circled"};var Spinner=function(){return{show:function(){var t={"z-index":"210000"};$("#globalSpinner").css(t).addClass("activeSpinner").attr("data-test-id","active-spinner")},hide:function(){$("#globalSpinner").removeClass("activeSpinner").removeAttr("style").removeAttr("data-test-id")}}}(),delay=function(){var t=0;return function(e,i){clearTimeout(t),t=setTimeout(e,i)}}(),click_through_batch_actions=function(){var t="click-through-batch-action";$(document).on("click",bc_datajs_selector("click-through-batch-action"),function(){var e=$(this),i=(e.data("event"),{event:$(this).data("event"),pathname:this.pathname});$.cookie(t,JSON.stringify(i),{expires:1,path:"/"})});var e=$.cookie(t);if(e){e=JSON.parse(e);var i=e.event,n=e.pathname;if($.removeCookie(t,{path:"/"}),window.location.pathname!==n)return;$.datajs("batch-action-master-checkbox").prop("checked",!0).trigger("change");var o=$.datajs("batch-action-button").filter('[data-event="'+i+'"]');if(o.is("[disabled]")){var s=o.parent(bc_datajs_selector("batch-action-tooltip-wrapper"));s.length&&(s.focus().tooltip("show"),setTimeout(function(){s.tooltip("hide")},6e3))}else o.click()}},validate_jacket_image=function(t){if(t.attr("src")!==t.attr("fallback")){var e=new Image;e.onerror=function(){t.attr("src",t.attr("fallback"))},e.onload=function(){t.attr("src")!==t.attr("fallback")&&(e.width<=1||e.height<=1)&&t.attr("src",t.attr("fallback"))},e.src=t.attr("src")}};String.prototype.strip_scripts=function(){var t=this.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"");return t},String.prototype.splice=function(t,e){return this.slice(0,t)+s+this.slice(t+Math.abs(e))},String.prototype.get_val=function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e="[\\?&]"+t+"=([^&#]*)",i=new RegExp(e),n=i.exec(this);return null==n?"":decodeURIComponent(n[1].replace(/\+/g," "))},Array.prototype.in_array=function(t){for(var e=0,i=this.length;i>e;e++)if(this[e]==t)return!0;return!1},Array.prototype.associate=function(t){for(var e={},i=Math.min(this.length,t.length),n=0;i>n;n++)e[t[n]]=this[n];return e},String.prototype.capitalize=function(){return this.toLowerCase().replace(/(^|\s)([a-z])/g,function(t,e,i){return e+i.toUpperCase()})},"undefined"!=typeof $.validator&&($.validator.addMethod("phoneUS",function(t,e){return t=t.replace(/\s+/g,""),this.optional(e)||t.length>9&&t.match(/^(1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)},"Please specify a valid US phone number."),$.validator.addMethod("validUsername",validUsername,localized_validator_messages.user_name.matchesPattern),$.validator.addMethod("s4pYearRange",function(t,e,i){return/^\d+$/.test(t)&&4==t.length&&t>=1901&&i>=t},jQuery.validator.format(localized_validator_messages.s4pYearRange)),$.validator.addMethod("twitterhandle",function(t){if(""==t)return!0;var e=/^\w{1,32}$/,i=e.test(t);return i},jQuery.validator.format(localized_validator_messages.twitterusername)));var init_more_actions_overlay=function(t){window.BC_TEMPLATES=window.BC_TEMPLATES||{},BC_TEMPLATES.MORE_ACTIONS_TMPL=window.BC_TEMPLATES.MORE_ACTIONS_TMPL,!BC_TEMPLATES.MORE_ACTIONS_TMPL&&$("#list_more_actions_tmpl").length&&(BC_TEMPLATES.MORE_ACTIONS_TMPL=Handlebars.compile($("#list_more_actions_tmpl").html())),$.datajs("more-actions-btn").bc_inline_overlay({animation:!1,classes:"more_actions_overlay",content:function(){var t=BC_TEMPLATES.MORE_ACTIONS_TMPL(this.$trigger.data()),e=$("<div></div>").html(t),i=this.$container.datajs("action-link").clone().removeClass("btn-link pull-right pull-left text-right text-left").addClass("list-group-item"),n=this.$container.datajs("more_actions_info").clone();return e.datajs("more_actions_info_container").append(n),e.datajs("append-links").append(i),e.datajs("append-links").find("span[data-toggle~=tooltip]").each(function(){var t=$(this);t.html(t.data("title"))}),e.html()},open_callback:function(e){return t(),init_shelf_inline_overlay(),e.$element.datajs("action-link").one("show.bc.inline_overlay",function(t,i){i.data("bc.inline_overlay").$container=e.$container,e.close()}),e.$element.datajs("single-click-list-action").on("ajax:success",function(t,i){var n=$('<div class="col-xs-12"></div>').html(i.messages);e.$element.datajs("more_actions_info_container").append(n),e.$element.datajs("append-links").hide(),setTimeout(window.location.reload.bind(window.location),2e3)}),!0},close_callback:function(t){t.$element.html("")}})},init_shelf_inline_overlay=function(){$.datajs("shelf-inline-overlay").bc_inline_overlay({classes:"cp_shelf_inline_overlay",container:null,open_callback:function(t){var e=null,i=t.$trigger.data("bs.tooltip");i&&(i.options.title=t.$trigger.data("on-shelf-text")),t.$element.on("change.bc.shelf_dropdown",bc_datajs_selector("shelf-actions"),function(e,n){var o=t.$element.datajs("shelf_message");if(o.parent()&&o.parent().parent()){var s=o.parent().parent();s.addClass("alert-success cp_alert").find("strong").show(),s.find(".alert_icon").removeClass("hidden")}o.html(o.data(n?"deleted":"moved")),n?(t.$element.fadeOut(1500,function(){t.close()}),i&&(i.options.title=t.$trigger.data("default-tooltip-text"))):i&&(i.options.title=t.$trigger.data("on-shelf-text")),t.$trigger.toggleClass("on_shelf",!n)}),t.$trigger.addClass("on_shelf"),t.$element.on("click.bc.shelf_dropdown",bc_datajs_selector("privacy-toggle"),function(t){e&&(clearTimeout(e),e=null),t.preventDefault();var i=$(this),n=!i.data("private"),o={id:i.data("bib-id"),is_private_check:!0,no_reload:!0};n&&(o.is_private=!0),e=setTimeout(function(){$.ajax({type:"POST",dataType:"json",url:"/usercontent/update",data:o,inline_messaging:!0,show_spinner:!1}).always(function(){e&&(clearTimeout(e),e=null)})},300);var s=i.data((n?"private":"public")+"-text");i.datajs("privacy_label").html(s),i.data("private",n),i.find("i").removeAttr("class").addClass(n?"icon-lock":"icon-lock-open")})},close_callback:function(t){t.$element.css("display","").css("opacity",""),t.$element.off(".shelf_dropdown")}})};!function(t){t.fn.simple_post=function(){return this.each(function(){this_link=t(this),this_link.bind("click",function(e){e.preventDefault(),t.post(this_link.attr("href"),null,null,"json")})})}}(jQuery);var addWindowEvent=window.addEventListener||window.attachEvent;addWindowEvent("beforeunload",function(){window.dont_spin||Spinner.show(),window.dont_spin=!1}),addWindowEvent("unload",function(){"undefined"!=typeof Spinner&&Spinner.hide()}),function(t){t.fn.setFocus=function(){return this.each(function(){var e=t(this);e.is(":visible")&&e.focus()})}}(jQuery),function(t){t.fn.enterkey=function(e,i){i&&e&&t(this).keydown(function(t){return t.which==e?(i(),!1):void 0})}}(jQuery),function(t){t.fn.triggerDisable=function(e){return this.each(function(){var i=t(this),n=e.triggers;n.bind("click",function(){var e=!0;n.each(function(){t(this).attr("checked")&&(e=!1)}),1==e?i.attr("disabled","disabled"):i.removeAttr("disabled"),t(".selectpicker").selectpicker("refresh")})})}}(jQuery),Array.prototype.clean=function(t){for(var e=0;e<this.length;e++)this[e]==t&&(this.splice(e,1),e--);return this},Array.prototype.set=function(t,e){return(!this[t]||this.hasOwnProperty(t))&&(this[t]=e),this},String.prototype.contains=function(t,e){return-1!=this.indexOf(t,e)},toQueryString=function(t){var e=[];return $.each(t,function(t,i){var n=t+"="+encodeURIComponent(i);e.push(n)}),e.join("&")};var BCPrint={print_without_jacket_covers:function(){$.datajs("title-heading").attr("colspan",1),$.datajs("item-image").hide()},print_with_jacket_covers:function(){$.datajs("title-heading").attr("colspan",2),$.datajs("item-image").show()}};String.prototype.parseQueryString=function(){var t=this.split(/[&;]/),e={};return t.length&&$.each(t,function(t,i){var n=i.split("=");n.length&&2==n.length&&(e[decodeURIComponent(n[0])]=decodeURIComponent(n[1].replace(/\+/g,"%20")))}),e},"msie"===$.browser&&"7.0"==$.browser.version&&$("#mainNav .dropDownContent a").hover(function(){$(this).parent("li").parent("ul").parent("div.dropDownContent").css("visibility","visible"),$(this).parent("li").parent("ul").parent("li.navColumn").parent("ul").parent("div.dropDownContent").css("visibility","visible"),$(this).parent("li").parent("ul").parent("li.navColumn").parent("ul").parent("li").parent("ul").parent("div.dropDownContent").css("visibility","visible")},function(){$(this).parent("li").parent("ul").parent("div.dropDownContent").css("visibility","hidden"),$(this).parent("li").parent("ul").parent("li.navColumn").parent("ul").parent("div.dropDownContent").css("visibility","hidden"),$(this).parent("li").parent("ul").parent("li.navColumn").parent("ul").parent("li").parent("ul").parent("div.dropDownContent").css("visibility","hidden")}),$.ajaxPrefilter(function(t,e,i){!t.crossDomain&&window.AUTH_TOKEN&&"undefined"!=typeof DOAUTH&&DOAUTH===!0&&i.setRequestHeader("X-CSRF-Token",AUTH_TOKEN),is_responsive_page()&&!t.crossDomain&&i.setRequestHeader("X-RESPONSIVE-PAGE",!0),e.inline_messaging&&i.setRequestHeader("X-SKIP-BC-GLOBAL-MESSAGING",!0)}),$.ajaxSetup({dataFilter:function(t,e){if("json"===e){var i;try{i=$.parseJSON(t)}catch(n){return t}return"object"!=typeof i||null===i?t:(i.messages&&i.skip_global_messaging===!0&&i.skip_message_conversion!==!0&&(i.messages=i.messages.map(function(t){var e=BC_MESSAGE_TYPE_TO_BOOTSTRAP_MAP[t.type];return'<div class="cp_alert alert alert-'+e+'" role="alert" data-test-id="alert-'+e+'"><div class="alert_icon"><i class="'+BC_MESSAGE_TYPE_TO_ICON_MAP[t.type]+'"></i></div><div class="alert_text">'+t.key+"</div></div>"}).join("")),JSON.stringify(i))}return t}}),$(document).ajaxSend(function(t,e,i){"script"!=i.dataType&&"undefined"!=typeof Spinner&&0!=i.show_spinner&&Spinner.show()}),$(document).ajaxSuccess(function(t,e,i){if(!i.from_login&&"script"!==i.dataType&&"json"===i.dataType){var n=i,o=jQuery.parseJSON(e.responseText),i=$.extend({},i,o);if(i.success&&i.analytics){const s=_.get(i,["analytics","ga4","method"],null);if(s){const a=window.BiblioCommonsSDK||null;a&&a.onAnalyticsReady?a.onAnalyticsReady(function(t){if(t[s]){const e=_.get(i,["analytics","ga4","args"],[]);t[s].apply(null,e)}else console.error("BiblioCommons SDK does not have method:",s)}):console.error("BiblioCommons SDK with onAnalyticsReady handler not found")}}if("authentication"==i.error){if(!i.redirect)return void window.location.reload();window.is_responsive_registration?BCLogin.show_modal(null,{url:i.redirect,success:function(t){var e=n.data?[n.data]:[];e.unshift("retain_messages=true"),$.ajax({from_login:t.from_login,contentType:n.contentType,dataType:n.dataType,method:n.method,url:n.url,data:e.join("&"),type:n.type}).always(function(){window.location.href=t.redirect?t.redirect:window.location.href})}}):$.modal("show",{source_url:i.redirect,fixed_width:"400px",send_forms:!0,aria_describedby:"aria_log_in",close_callback:auth_modal_close})}else if(window.is_responsive_registration&&i.is_registration)BCReg.settings.back_link=i.after_registration_redirect,BCReg.start();else if(i.custom_ils_error){var r=o.messages;custom_ils_error_popup(r[0].key),Messages.clear(),$.fn.popout("hide_content")}else{if(i.reload){var l=window.location.href,d=l.indexOf("#");return-1!=d&&(l=l.substring(0,d)),void(window.location.href=l)}if(i.static_html){var c={content:i.static_html,send_forms:!0,marked_for_reload:!0};$.modal("show",c)}else if(i.html&&i.render_as_popup){var p="undefined"!=typeof i.marked_for_reload?i.marked_for_reload:!0,c={content:i.html,send_forms:!0,marked_for_reload:p};i.width&&(c.width=i.width),$.modal("show",c)}else if(i.redirect){if(!i.render_as_popup)return void(window.location.href=i.redirect);var c={source_url:i.redirect,send_forms:!0,marked_for_reload:i.marked_for_reload};$.modal("show",c)}}}"undefined"==typeof Messages||i.custom_ils_error||i.skip_global_messaging||Messages.show(i.messages),i.success&&"undefined"!=typeof o&&o&&"undefined"!=typeof o.silent_login&&null!==o.silent_login&&($("#"+o.j_callback).length>0&&trigger_j_callback(o.j_callback),BC_USER_ID=o.bc_id,BC_USERNAME=o.bc_username,$(".silent_login_listener").trigger("contentchange")),"undefined"!=typeof Spinner&&Spinner.hide(),$(this).trigger("contentchange")}),$(document).ajaxError(function(t,e,i){0!=i.show_spinner&&"undefined"!=typeof Spinner&&Spinner.hide(),e.status>=500&&console.error("Request Failed For: "+i.url)}),$.browser.msie&&parseInt($.browser.version)<9&&!function(t,e,i){function n(e,i){return i=t.call(i,2),function(){"object"!=typeof e.apply&&"function"!=typeof e.apply||null===e.apply||e.apply(null,i)}}window.setTimeout=function(t,i){return e(n(t,arguments),i)},window.setInterval=function(t,e){return i(n(t,arguments),e)}}([].slice,setTimeout,setInterval);var scrapes=0,disabled=!1;!function(t){t.fn.click_n_sub=function(){return this.each(function(){t(this).bind("click",function(e){var i=t(this);e.preventDefault(),0==disabled&&(scrapes++,scrapes>=3&&(disabled=!0,t(".click_n_sub:not(.fetching)").html(od_localizations.wait_message),t(".digital_request span").html(od_localizations.wait_message)),i.html(od_localizations.fetch_message),i.addClass("fetching"),t.getJSON(t(this).attr("href"),function(e){e.success&&e.html&&(i.replaceWith(e.html),e.available&&t("#request_link_"+i.attr("id").split("_")[2]+" span").html(od_localizations.checkout),scrapes--,2>=scrapes&&1==disabled&&(disabled=!1,t(".click_n_sub:not(.fetching)").html(od_localizations.request_available),t(".digital_request span").html(od_localizations.digital_request)))}))})})}}(jQuery),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){"use strict";if(null==this)throw new TypeError;var e=Object(this),i=e.length>>>0;if(0===i)return-1;var n=0;if(arguments.length>1&&(n=Number(arguments[1]),n!=n?n=0:0!=n&&1/0!=n&&n!=-1/0&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=i)return-1;for(var o=n>=0?n:Math.max(i-Math.abs(n),0);i>o;o++)if(o in e&&e[o]===t)return o;return-1}),$(document).on("input keydown","textarea[maxlength]",function(t){var e=$(this),i=e.attr("maxlength");if(i){var n=e.val(),o=$("#"+e.attr("id")+"_character_count");o.length>0&&o.text(i-n.length),n.length>i&&(e.val(n.substring(0,i)),t.preventDefault())}}),function(t){t.fn.serializeObject=function(){var e={},i=this.serializeArray();return t.each(i,function(){void 0!==e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e}}(jQuery),function(t){t.fn.doubleTapDropdown=function(){var e="ontouchstart"in window||navigator.msMaxTouchPoints;if(e){var i=this;t(document).on("click.doubleTapDropdown",function(e){var n=t(e.target);t.inArray(e.target,i)>-1&&!n.data("tapped")?(e.preventDefault(),i.removeData("tapped"),n.data("tapped",!0)):i.removeData("tapped")})}return this}}(jQuery),/* ========================================================================
 * Bootstrap: alert.js v3.2.0
 * http://getbootstrap.com/javascript/#alerts
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),o=i.data("bs.alert");o||i.data("bs.alert",o=new n(this)),"string"==typeof e&&o[e].call(i)})}var i='[data-dismiss="alert"]',n=function(e){t(e).on("click",i,this.close)};n.VERSION="3.2.0",n.prototype.close=function(e){function i(){s.detach().trigger("closed.bs.alert").remove()}var n=t(this),o=n.attr("data-target");o||(o=n.attr("href"),o=o&&o.replace(/.*(?=#[^\s]*$)/,""));var s=t(o);e&&e.preventDefault(),s.length||(s=n.hasClass("alert")?n:n.parent()),s.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(s.removeClass("in"),t.support.transition&&s.hasClass("fade")?s.one("bsTransitionEnd",i).emulateTransitionEnd(150):i())};var o=t.fn.alert;t.fn.alert=e,t.fn.alert.Constructor=n,t.fn.alert.noConflict=function(){return t.fn.alert=o,this},t(document).on("click.bs.alert.data-api",i,n.prototype.close)}(jQuery),/* ========================================================================
 * Bootstrap: button.js v3.2.0
 * http://getbootstrap.com/javascript/#buttons
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),o=n.data("bs.button"),s="object"==typeof e&&e;o||n.data("bs.button",o=new i(this,s)),"toggle"==e?o.toggle():e&&o.setState(e)})}var i=function(e,n){this.$element=t(e),this.options=t.extend({},i.DEFAULTS,n),this.isLoading=!1};i.VERSION="3.2.0",i.DEFAULTS={loadingText:"loading..."},i.prototype.setState=function(e){var i="disabled",n=this.$element,o=n.is("input")?"val":"html",s=n.data();e+="Text",null==s.resetText&&n.data("resetText",n[o]()),n[o](null==s[e]?this.options[e]:s[e]),setTimeout(t.proxy(function(){"loadingText"==e?(this.isLoading=!0,n.addClass(i).attr(i,i)):this.isLoading&&(this.isLoading=!1,n.removeClass(i).removeAttr(i))},this),0)},i.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var i=this.$element.find("input");"radio"==i.prop("type")&&(i.prop("checked")&&this.$element.hasClass("active")?t=!1:e.find(".active").removeClass("active")),t&&i.prop("checked",!this.$element.hasClass("active")).trigger("change")}t&&this.$element.toggleClass("active")};var n=t.fn.button;t.fn.button=e,t.fn.button.Constructor=i,t.fn.button.noConflict=function(){return t.fn.button=n,this},t(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(i){var n=t(i.target);n.hasClass("btn")||(n=n.closest(".btn")),e.call(n,"toggle"),i.preventDefault()})}(jQuery),/* ========================================================================
 * Bootstrap: collapse.js v3.2.0
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),o=n.data("bs.collapse"),s=t.extend({},i.DEFAULTS,n.data(),"object"==typeof e&&e);!o&&s.toggle&&"show"==e&&(e=!e),o||n.data("bs.collapse",o=new i(this,s)),"string"==typeof e&&o[e]()})}var i=function(e,n){this.$element=t(e),this.options=t.extend({},i.DEFAULTS,n),this.transitioning=null,this.options.parent&&(this.$parent=t(this.options.parent)),this.options.toggle&&this.toggle()};i.VERSION="3.2.0",i.DEFAULTS={toggle:!0},i.prototype.dimension=function(){var t=this.$element.hasClass("width");return t?"width":"height"},i.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var i=t.Event("show.bs.collapse");if(this.$element.trigger(i),!i.isDefaultPrevented()){var n=this.$parent&&this.$parent.find("> .panel > .in");if(n&&n.length){var o=n.data("bs.collapse");if(o&&o.transitioning)return;e.call(n,"hide"),o||n.data("bs.collapse",null)}var s=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[s](0),this.transitioning=1;var a=function(){this.$element.removeClass("collapsing").addClass("collapse in")[s](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return a.call(this);var r=t.camelCase(["scroll",s].join("-"));this.$element.one("bsTransitionEnd",t.proxy(a,this)).emulateTransitionEnd(350)[s](this.$element[0][r])}}},i.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var i=this.dimension();this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var n=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};return t.support.transition?void this.$element[i](0).one("bsTransitionEnd",t.proxy(n,this)).emulateTransitionEnd(350):n.call(this)}}},i.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var n=t.fn.collapse;t.fn.collapse=e,t.fn.collapse.Constructor=i,t.fn.collapse.noConflict=function(){return t.fn.collapse=n,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(i){var n,o=t(this),s=o.attr("data-target")||i.preventDefault()||(n=o.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""),a=t(s),r=a.data("bs.collapse"),l=r?"toggle":o.data(),d=o.attr("data-parent"),c=d&&t(d);r&&r.transitioning||(c&&c.find('[data-toggle="collapse"][data-parent="'+d+'"]').not(o).addClass("collapsed"),o[a.hasClass("in")?"addClass":"removeClass"]("collapsed")),e.call(a,l)})}(jQuery),/* ========================================================================
 * Bootstrap: dropdown.js v3.2.0
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
+function(t){"use strict";function e(e){e&&3===e.which||(t(o).remove(),t(s).each(function(){var n=i(t(this)),o={relatedTarget:this};n.hasClass("open")&&(n.trigger(e=t.Event("hide.bs.dropdown",o)),e.isDefaultPrevented()||n.removeClass("open").trigger("hidden.bs.dropdown",o))}))}function i(e){var i=e.attr("data-target");i||(i=e.attr("href"),i=i&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,""));var n=i&&t(i);return n&&n.length?n:e.parent()}function n(e){return this.each(function(){var i=t(this),n=i.data("bs.dropdown");n||i.data("bs.dropdown",n=new a(this)),"string"==typeof e&&n[e].call(i)})}var o=".dropdown-backdrop",s='[data-toggle="dropdown"]',a=function(e){t(e).on("click.bs.dropdown",this.toggle)};a.VERSION="3.2.0",a.prototype.toggle=function(n){var o=t(this);if(!o.is(".disabled, :disabled")){var s=i(o),a=s.hasClass("open");if(e(),!a){"ontouchstart"in document.documentElement&&!s.closest(".navbar-nav").length&&t('<div class="dropdown-backdrop"/>').insertAfter(t(this)).on("click",e);var r={relatedTarget:this};if(s.trigger(n=t.Event("show.bs.dropdown",r)),n.isDefaultPrevented())return;o.trigger("focus"),s.toggleClass("open").trigger("shown.bs.dropdown",r)}return!1}},a.prototype.keydown=function(e){if(/(38|40|27)/.test(e.keyCode)){var n=t(this);if(e.preventDefault(),e.stopPropagation(),!n.is(".disabled, :disabled")){var o=i(n),a=o.hasClass("open");if(!a||a&&27==e.keyCode)return 27==e.which&&o.find(s).trigger("focus"),n.trigger("click");var r=" li:not(.divider):visible a",l=o.find('[role="menu"]'+r+', [role="listbox"]'+r);if(l.length){var d=l.index(l.filter(":focus"));38==e.keyCode&&d>0&&d--,40==e.keyCode&&d<l.length-1&&d++,~d||(d=0),l.eq(d).trigger("focus")}}}};var r=t.fn.dropdown;t.fn.dropdown=n,t.fn.dropdown.Constructor=a,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=r,this},t(document).on("click.bs.dropdown.data-api",e).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",s,a.prototype.toggle).on("keydown.bs.dropdown.data-api",s+', [role="menu"], [role="listbox"]',a.prototype.keydown)}(jQuery),function(t){var e="ArrowUp",i="ArrowDown",n="Tab",o=t.fn.dropdown.Constructor,s=window.BCHeaderConfig&&window.BCHeaderConfig.is_externally_rendered,a=t(s?".bc_core_external":document);a.off("shown.bs.dropdown").on("shown.bs.dropdown",function(s,a){function r(t){if([n,i,e].indexOf(t.key)>-1)if(t.stopImmediatePropagation(),t.key===n)setTimeout(function(){d.hasClass("open")&&document.activeElement&&0===p.find(document.activeElement).length&&o.prototype.toggle.call(c)},10);else if(p.is("ul")||p.data("listbox")){var s=p.find(":tabbable");if(s.length>1){t.preventDefault();var a=s.index(p.find(":focus")),r=s.length-1;if(t.key===i)var l=s.eq(a===r?0:a+1);else var l=s.eq(0===a?r:a-1);l.focus()}}}function l(){c.attr("aria-expanded",!1),p.attr("aria-hidden",!0),d.off("hidden.bs.dropdown",l),p.off("keydown.bs.dropdown",r);var t=d.datajs("sr-only-dropdown-toggle");t.html(t.data("text-collapsed"))}if(s.target&&a.relatedTarget){var d=t(s.target),c=t(a.relatedTarget),p=d.find(".dropdown-menu"),h=c.attr("data-focus"),u=null,f=d.datajs("sr-only-dropdown-toggle");f.html(f.data("text-expanded")),c.attr("aria-expanded",!0),p.attr("aria-hidden",!1),h&&(u=p.find(h).first()),u&&0!==u.length||(u=p.find("h2:first, label:first, :focusable:first").first()),u.length&&(u.is(":focusable")||u.attr("tabIndex",-1),u.focus()),d.on("hidden.bs.dropdown",l),p.on("keydown.bs.dropdown",r)}})}(jQuery),/* ========================================================================
 * Bootstrap: tooltip.js v3.2.0
 * http://getbootstrap.com/javascript/#tooltip
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),o=n.data("bs.tooltip"),s="object"==typeof e&&e;(o||"destroy"!=e)&&(o||n.data("bs.tooltip",o=new i(this,s)),"string"==typeof e&&o[e]())})}var i=function(t,e){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",t,e)};i.VERSION="3.2.0",i.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},i.prototype.init=function(e,i,n){this.enabled=!0,this.type=e,this.$element=t(i),this.options=this.getOptions(n),this.$viewport=this.options.viewport&&t(this.options.viewport.selector||this.options.viewport);for(var o=this.options.trigger.split(" "),s=o.length;s--;){var a=o[s];if("click"==a)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=a){var r="hover"==a?"mouseenter":"focusin",l="hover"==a?"mouseleave":"focusout";this.$element.on(r+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},i.prototype.getDefaults=function(){return i.DEFAULTS},i.prototype.getOptions=function(e){return e=t.extend({},this.getDefaults(),this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},i.prototype.getDelegateOptions=function(){var e={},i=this.getDefaults();return this._options&&t.each(this._options,function(t,n){i[t]!=n&&(e[t]=n)}),e},i.prototype.enter=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),clearTimeout(i.timeout),i.hoverState="in",i.options.delay&&i.options.delay.show?void(i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)):i.show()},i.prototype.leave=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),clearTimeout(i.timeout),i.hoverState="out",i.options.delay&&i.options.delay.hide?void(i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)):i.hide()},i.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var i=t.contains(document.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!i)return;var n=this,o=this.tip(),s=this.getUID(this.type);this.setContent(),o.attr("id",s),this.$element.attr("aria-describedby",s),this.options.animation&&o.addClass("fade");var a="function"==typeof this.options.placement?this.options.placement.call(this,o[0],this.$element[0]):this.options.placement,r=/\s?auto?\s?/i,l=r.test(a);l&&(a=a.replace(r,"")||"top"),o.detach().css({top:0,left:0,display:"block"}).addClass(a).data("bs."+this.type,this),this.options.container?o.appendTo(this.options.container):o.insertAfter(this.$element);var d=this.getPosition(),c=o[0].offsetWidth,p=o[0].offsetHeight;if(l){var h=a,u=this.$element.parent(),f=this.getPosition(u);a="bottom"==a&&d.top+d.height+p-f.scroll>f.height?"top":"top"==a&&d.top-f.scroll-p<0?"bottom":"right"==a&&d.right+c>f.width?"left":"left"==a&&d.left-c<f.left?"right":a,o.removeClass(h).addClass(a)}var g=this.getCalculatedOffset(a,d,c,p);this.applyPlacement(g,a);var m=function(){n.$element.trigger("shown.bs."+n.type),n.hoverState=null};t.support.transition&&this.$tip.hasClass("fade")?o.one("bsTransitionEnd",m).emulateTransitionEnd(150):m()}},i.prototype.applyPlacement=function(e,i){var n=this.tip(),o=n[0].offsetWidth,s=n[0].offsetHeight,a=parseInt(n.css("margin-top"),10),r=parseInt(n.css("margin-left"),10);isNaN(a)&&(a=0),isNaN(r)&&(r=0),e.top=e.top+a,e.left=e.left+r,t.offset.setOffset(n[0],t.extend({using:function(t){n.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),n.addClass("in");var l=n[0].offsetWidth,d=n[0].offsetHeight;"top"==i&&d!=s&&(e.top=e.top+s-d);var c=this.getViewportAdjustedDelta(i,e,l,d);c.left?e.left+=c.left:e.top+=c.top;var p=c.left?2*c.left-o+l:2*c.top-s+d,h=c.left?"left":"top",u=c.left?"offsetWidth":"offsetHeight";n.offset(e),this.replaceArrow(p,n[0][u],h)},i.prototype.replaceArrow=function(t,e,i){this.arrow().css(i,t?50*(1-t/e)+"%":"")},i.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},i.prototype.hide=function(){function e(){"in"!=i.hoverState&&n.detach(),i.$element.trigger("hidden.bs."+i.type)}var i=this,n=this.tip(),o=t.Event("hide.bs."+this.type);return this.$element.removeAttr("aria-describedby"),this.$element.trigger(o),o.isDefaultPrevented()?void 0:(n.removeClass("in"),t.support.transition&&this.$tip.hasClass("fade")?n.one("bsTransitionEnd",e).emulateTransitionEnd(150):e(),this.hoverState=null,this)},i.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},i.prototype.hasContent=function(){return this.getTitle()},i.prototype.getPosition=function(e){e=e||this.$element;var i=e[0],n="BODY"==i.tagName;return t.extend({},"function"==typeof i.getBoundingClientRect?i.getBoundingClientRect():null,{scroll:n?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop(),width:n?t(window).width():e.outerWidth(),height:n?t(window).height():e.outerHeight()},n?{top:0,left:0}:e.offset())},i.prototype.getCalculatedOffset=function(t,e,i,n){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-n,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-n/2,left:e.left-i}:{top:e.top+e.height/2-n/2,left:e.left+e.width}},i.prototype.getViewportAdjustedDelta=function(t,e,i,n){var o={top:0,left:0};if(!this.$viewport)return o;var s=this.options.viewport&&this.options.viewport.padding||0,a=this.getPosition(this.$viewport);if(/right|left/.test(t)){var r=e.top-s-a.scroll,l=e.top+s-a.scroll+n;r<a.top?o.top=a.top-r:l>a.top+a.height&&(o.top=a.top+a.height-l)}else{var d=e.left-s,c=e.left+s+i;d<a.left?o.left=a.left-d:c>a.width&&(o.left=a.left+a.width-c)}return o},i.prototype.getTitle=function(){var t,e=this.$element,i=this.options;return t=e.attr("data-original-title")||("function"==typeof i.title?i.title.call(e[0]):i.title)},i.prototype.getUID=function(t){do t+=~~(1e6*Math.random());while(document.getElementById(t));return t},i.prototype.tip=function(){return this.$tip=this.$tip||t(this.options.template)},i.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},i.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},i.prototype.enable=function(){this.enabled=!0},i.prototype.disable=function(){this.enabled=!1},i.prototype.toggleEnabled=function(){this.enabled=!this.enabled},i.prototype.toggle=function(e){var i=this;e&&(i=t(e.currentTarget).data("bs."+this.type),i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i))),i.tip().hasClass("in")?i.leave(i):i.enter(i)},i.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var n=t.fn.tooltip;t.fn.tooltip=e,t.fn.tooltip.Constructor=i,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=n,this}}(jQuery),/* ========================================================================
 * Bootstrap: popover.js v3.2.0
 * http://getbootstrap.com/javascript/#popovers
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),o=n.data("bs.popover"),s="object"==typeof e&&e;(o||"destroy"!=e)&&(o||n.data("bs.popover",o=new i(this,s)),"string"==typeof e&&o[e]())})}var i=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");i.VERSION="3.2.0",i.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),i.prototype=t.extend({},t.fn.tooltip.Constructor.prototype),i.prototype.constructor=i,i.prototype.getDefaults=function(){return i.DEFAULTS},i.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),i=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content").empty()[this.options.html?"string"==typeof i?"html":"append":"text"](i),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},i.prototype.hasContent=function(){return this.getTitle()||this.getContent()},i.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},i.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},i.prototype.tip=function(){return this.$tip||(this.$tip=t(this.options.template)),this.$tip};var n=t.fn.popover;t.fn.popover=e,t.fn.popover.Constructor=i,t.fn.popover.noConflict=function(){return t.fn.popover=n,this}}(jQuery),/* ========================================================================
 * Bootstrap: tab.js v3.2.0
 * http://getbootstrap.com/javascript/#tabs
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),o=n.data("bs.tab");o||n.data("bs.tab",o=new i(this)),"string"==typeof e&&o[e]()})}var i=function(e){this.element=t(e)};i.VERSION="3.2.0",i.prototype.show=function(){var e=this.element,i=e.closest("ul:not(.dropdown-menu)"),n=e.data("target");if(n||(n=e.attr("href"),n=n&&n.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var o=i.find(".active:last a")[0],s=t.Event("show.bs.tab",{relatedTarget:o});if(e.trigger(s),!s.isDefaultPrevented()){var a=t(n);this.activate(e.closest("li"),i),this.activate(a,a.parent(),function(){e.trigger({type:"shown.bs.tab",relatedTarget:o})})}}},i.prototype.activate=function(e,i,n){function o(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),e.addClass("active"),a?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu")&&e.closest("li.dropdown").addClass("active"),n&&n()}var s=i.find("> .active"),a=n&&t.support.transition&&s.hasClass("fade");a?s.one("bsTransitionEnd",o).emulateTransitionEnd(150):o(),s.removeClass("in")};var n=t.fn.tab;t.fn.tab=e,t.fn.tab.Constructor=i,t.fn.tab.noConflict=function(){return t.fn.tab=n,this},t(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(i){i.preventDefault(),e.call(t(this),"show")})}(jQuery),/* ========================================================================
 * Bootstrap: transition.js v3.2.0
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
+function(t){"use strict";function e(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in e)if(void 0!==t.style[i])return{end:e[i]};return!1}t.fn.emulateTransitionEnd=function(e){var i=!1,n=this;t(this).one("bsTransitionEnd",function(){i=!0});var o=function(){i||t(n).trigger(t.support.transition.end)};return setTimeout(o,e),this},t(function(){t.support.transition=e(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(e){return t(e.target).is(this)?e.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),function(t){"use strict";function e(e){var i=[{re:/[\xC0-\xC6]/g,ch:"A"},{re:/[\xE0-\xE6]/g,ch:"a"},{re:/[\xC8-\xCB]/g,ch:"E"},{re:/[\xE8-\xEB]/g,ch:"e"},{re:/[\xCC-\xCF]/g,ch:"I"},{re:/[\xEC-\xEF]/g,ch:"i"},{re:/[\xD2-\xD6]/g,ch:"O"},{re:/[\xF2-\xF6]/g,ch:"o"},{re:/[\xD9-\xDC]/g,ch:"U"},{re:/[\xF9-\xFC]/g,ch:"u"},{re:/[\xC7-\xE7]/g,ch:"c"},{re:/[\xD1]/g,ch:"N"},{re:/[\xF1]/g,ch:"n"}];return t.each(i,function(){e=e.replace(this.re,this.ch)}),e}function i(t){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},i="(?:"+Object.keys(e).join("|")+")",n=new RegExp(i),o=new RegExp(i,"g"),s=null==t?"":""+t;return n.test(s)?s.replace(o,function(t){return e[t]}):s}function n(e,i){var n=arguments,s=e,a=i;[].shift.apply(n);var r,l=this.each(function(){var e=t(this);if(e.is("select")){var i=e.data("selectpicker"),l="object"==typeof s&&s;if(i){if(l)for(var d in l)l.hasOwnProperty(d)&&(i.options[d]=l[d])}else{var c=t.extend({},o.DEFAULTS,t.fn.selectpicker.defaults||{},e.data(),l);c.template=t.extend({},o.DEFAULTS.template,t.fn.selectpicker.defaults?t.fn.selectpicker.defaults.template:{},e.data().template,l.template),e.data("selectpicker",i=new o(this,c,a))}"string"==typeof s&&(r=i[s]instanceof Function?i[s].apply(i,n):i.options[s])}});return"undefined"!=typeof r?r:l}String.prototype.includes||!function(){var t={}.toString,e=function(){try{var t={},e=Object.defineProperty,i=e(t,t,t)&&e}catch(n){}return i}(),i="".indexOf,n=function(e){if(null==this)throw new TypeError;var n=String(this);if(e&&"[object RegExp]"==t.call(e))throw new TypeError;var o=n.length,s=String(e),a=s.length,r=arguments.length>1?arguments[1]:void 0,l=r?Number(r):0;l!=l&&(l=0);var d=Math.min(Math.max(l,0),o);return a+d>o?!1:-1!=i.call(n,s,l)};e?e(String.prototype,"includes",{value:n,configurable:!0,writable:!0}):String.prototype.includes=n}(),String.prototype.startsWith||!function(){var t=function(){try{var t={},e=Object.defineProperty,i=e(t,t,t)&&e}catch(n){}return i}(),e={}.toString,i=function(t){if(null==this)throw new TypeError;var i=String(this);if(t&&"[object RegExp]"==e.call(t))throw new TypeError;var n=i.length,o=String(t),s=o.length,a=arguments.length>1?arguments[1]:void 0,r=a?Number(a):0;r!=r&&(r=0);var l=Math.min(Math.max(r,0),n);if(s+l>n)return!1;for(var d=-1;++d<s;)if(i.charCodeAt(l+d)!=o.charCodeAt(d))return!1;return!0};t?t(String.prototype,"startsWith",{value:i,configurable:!0,writable:!0}):String.prototype.startsWith=i}(),Object.keys||(Object.keys=function(t,e,i){i=[];for(e in t)i.hasOwnProperty.call(t,e)&&i.push(e);return i}),t.fn.triggerNative=function(t){var e,i=this[0];i.dispatchEvent?("function"==typeof Event?e=new Event(t,{bubbles:!0}):(e=document.createEvent("Event"),e.initEvent(t,!0,!1)),i.dispatchEvent(e)):(i.fireEvent&&(e=document.createEventObject(),e.eventType=t,i.fireEvent("on"+t,e)),this.trigger(t))},t.expr[":"].icontains=function(e,i,n){var o=t(e),s=(o.data("tokens")||o.text()).toUpperCase();return s.includes(n[3].toUpperCase())},t.expr[":"].ibegins=function(e,i,n){var o=t(e),s=(o.data("tokens")||o.text()).toUpperCase();return s.startsWith(n[3].toUpperCase())},t.expr[":"].aicontains=function(e,i,n){var o=t(e),s=(o.data("tokens")||o.data("normalizedText")||o.text()).toUpperCase();return s.includes(n[3].toUpperCase())},t.expr[":"].aibegins=function(e,i,n){var o=t(e),s=(o.data("tokens")||o.data("normalizedText")||o.text()).toUpperCase();return s.startsWith(n[3].toUpperCase())};var o=function(e,i,n){n&&n.stopPropagation&&n.preventDefault&&(n.stopPropagation(),n.preventDefault()),this.$element=t(e),this.$newElement=null,this.$button=null,this.$menu=null,this.$lis=null,this.options=i,null===this.options.title&&(this.options.title=this.$element.attr("title")),this.val=o.prototype.val,this.render=o.prototype.render,this.refresh=o.prototype.refresh,this.setStyle=o.prototype.setStyle,this.selectAll=o.prototype.selectAll,this.deselectAll=o.prototype.deselectAll,this.destroy=o.prototype.remove,this.remove=o.prototype.remove,this.show=o.prototype.show,this.hide=o.prototype.hide,this.init()};o.VERSION="1.7.2",o.DEFAULTS={noneSelectedText:"Nothing selected",noneResultsText:"No results matched {0}",countSelectedText:function(t){return 1==t?"{0} item selected":"{0} items selected"},maxOptionsText:function(t,e){return[1==t?"Limit reached ({n} item max)":"Limit reached ({n} items max)",1==e?"Group limit reached ({n} item max)":"Group limit reached ({n} items max)"]},selectAllText:"Select All",deselectAllText:"Deselect All",doneButton:!1,doneButtonText:"Close",multipleSeparator:", ",styleBase:"btn",style:"btn-default",size:"auto",title:null,selectedTextFormat:"values",width:!1,container:!1,hideDisabled:!1,showSubtext:!1,showIcon:!0,showContent:!0,dropupAuto:!0,header:!1,liveSearch:!1,liveSearchPlaceholder:null,liveSearchNormalize:!1,liveSearchStyle:"contains",actionsBox:!1,iconBase:"glyphicon",tickIcon:"glyphicon-ok",template:{caret:'<span class="caret"></span>'},maxOptions:!1,mobile:!1,selectOnTab:!1,dropdownAlignRight:!1},o.prototype={constructor:o,init:function(){var e=this,i=this.$element.attr("id");this.$element.addClass("bs-select-hidden"),this.liObj={},this.multiple=this.$element.prop("multiple"),this.autofocus=this.$element.prop("autofocus"),this.$newElement=this.createView(),this.$element.after(this.$newElement),this.$button=this.$newElement.children("button"),this.$menu=this.$newElement.children(".dropdown-menu"),this.$menuInner=this.$menu.children(".inner"),this.$searchbox=this.$menu.find("input"),this.options.dropdownAlignRight&&this.$menu.addClass("dropdown-menu-right"),"undefined"!=typeof i&&(this.$button.attr("data-id",i),t('label[for="'+i+'"]').click(function(t){t.preventDefault(),e.$button.focus()})),this.checkDisabled(),this.clickListener(),this.options.liveSearch&&this.liveSearchListener(),this.render(),this.setStyle(),this.setWidth(),this.options.container&&this.selectPosition(),this.$menu.data("this",this),this.$newElement.data("this",this),this.options.mobile&&this.mobile(),this.$newElement.on({"hide.bs.dropdown":function(t){e.$element.trigger("hide.bs.select",t)},"hidden.bs.dropdown":function(t){e.$element.trigger("hidden.bs.select",t)},"show.bs.dropdown":function(t){e.$element.trigger("show.bs.select",t)},"shown.bs.dropdown":function(t){e.$element.trigger("shown.bs.select",t)}}),setTimeout(function(){e.$element.trigger("loaded.bs.select")})},createDropdown:function(){var e=this.multiple?" show-tick":"",n=this.$element.parent().hasClass("input-group")?" input-group-btn":"",o=this.autofocus?" autofocus":"",s=this.options.header?'<div class="popover-title"><button type="button" class="close" aria-hidden="true">&times;</button>'+this.options.header+"</div>":"",a=this.options.liveSearch?'<div class="bs-searchbox"><input type="text" class="form-control" autocomplete="off"'+(null===this.options.liveSearchPlaceholder?"":' placeholder="'+i(this.options.liveSearchPlaceholder)+'"')+"></div>":"",r=this.multiple&&this.options.actionsBox?'<div class="bs-actionsbox"><div class="btn-group btn-group-sm btn-block"><button type="button" class="actions-btn bs-select-all btn btn-default">'+this.options.selectAllText+'</button><button type="button" class="actions-btn bs-deselect-all btn btn-default">'+this.options.deselectAllText+"</button></div></div>":"",l=this.multiple&&this.options.doneButton?'<div class="bs-donebutton"><div class="btn-group btn-block"><button type="button" class="btn btn-sm btn-default">'+this.options.doneButtonText+"</button></div></div>":"",d='<div class="btn-group bootstrap-select'+e+n+'"><button type="button" class="'+this.options.styleBase+' dropdown-toggle" data-toggle="dropdown"'+o+'><span class="filter-option pull-left"></span>&nbsp;<span class="bs-caret">'+this.options.template.caret+'</span></button><div class="dropdown-menu open">'+s+a+r+'<ul class="dropdown-menu inner"></ul>'+l+"</div></div>";return t(d)},createView:function(){var t=this.createDropdown(),e=this.createLi();return t.find("ul")[0].innerHTML=e,t},reloadLi:function(){this.destroyLi();var t=this.createLi();this.$menuInner[0].innerHTML=t},destroyLi:function(){this.$menu.find("li").remove()},createLi:function(){var n=this,o=[],s=0,a=document.createElement("option"),r=-1,l=function(t,e,i,n){return"<li"+("undefined"!=typeof i&""!==i?' class="'+i+'"':"")+("undefined"!=typeof e&null!==e?' data-original-index="'+e+'"':"")+("undefined"!=typeof n&null!==n?'data-optgroup="'+n+'"':"")+">"+t+"</li>"},d=function(t,o,s,a){return'<a tabindex="0"'+("undefined"!=typeof o?' class="'+o+'"':"")+("undefined"!=typeof s?' style="'+s+'"':"")+(n.options.liveSearchNormalize?' data-normalized-text="'+e(i(t))+'"':"")+("undefined"!=typeof a||null!==a?' data-tokens="'+a+'"':"")+">"+t+'<span class="'+n.options.iconBase+" "+n.options.tickIcon+' check-mark"></span></a>'};if(this.options.title&&!this.multiple&&(r--,!this.$element.find(".bs-title-option").length)){var c=this.$element[0];a.className="bs-title-option",a.appendChild(document.createTextNode(this.options.title)),a.value="",c.insertBefore(a,c.firstChild),void 0===t(c.options[c.selectedIndex]).attr("selected")&&(a.selected=!0)}return this.$element.find("option").each(function(e){var i=t(this);if(r++,!i.hasClass("bs-title-option")){var a=this.className||"",c=this.style.cssText,p=i.data("content")?i.data("content"):i.html(),h=i.data("tokens")?i.data("tokens"):null,u="undefined"!=typeof i.data("subtext")?'<small class="text-muted">'+i.data("subtext")+"</small>":"",f="undefined"!=typeof i.data("icon")?'<span class="'+n.options.iconBase+" "+i.data("icon")+'"></span> ':"",g=this.disabled||"OPTGROUP"===this.parentElement.tagName&&this.parentElement.disabled;if(""!==f&&g&&(f="<span>"+f+"</span>"),n.options.hideDisabled&&g)return void r--;if(i.data("content")||(p=f+'<span class="text">'+p+u+"</span>"),"OPTGROUP"===this.parentElement.tagName&&i.data("divider")!==!0){var m=" "+this.parentElement.className||"";if(0===i.index()){s+=1;var v=this.parentElement.label,b="undefined"!=typeof i.parent().data("subtext")?'<small class="text-muted">'+i.parent().data("subtext")+"</small>":"",_=i.parent().data("icon")?'<span class="'+n.options.iconBase+" "+i.parent().data("icon")+'"></span> ':"";v=_+'<span class="text">'+v+b+"</span>",0!==e&&o.length>0&&(r++,o.push(l("",null,"divider",s+"div"))),r++,o.push(l(v,null,"dropdown-header"+m,s))}o.push(l(d(p,"opt "+a+m,c,h),e,"",s))}else i.data("divider")===!0?o.push(l("",e,"divider")):i.data("hidden")===!0?o.push(l(d(p,a,c,h),e,"hidden is-hidden")):(this.previousElementSibling&&"OPTGROUP"===this.previousElementSibling.tagName&&(r++,o.push(l("",null,"divider",s+"div"))),o.push(l(d(p,a,c,h),e)));n.liObj[e]=r}}),this.multiple||0!==this.$element.find("option:selected").length||this.options.title||this.$element.find("option").eq(0).prop("selected",!0).attr("selected","selected"),o.join("")},findLis:function(){return null==this.$lis&&(this.$lis=this.$menu.find("li")),this.$lis},render:function(e){var i,n=this;e!==!1&&this.$element.find("option").each(function(t){var e=n.findLis().eq(n.liObj[t]);n.setDisabled(t,this.disabled||"OPTGROUP"===this.parentElement.tagName&&this.parentElement.disabled,e),n.setSelected(t,this.selected,e)}),this.tabIndex();var o=this.$element.find("option").map(function(){if(this.selected){if(n.options.hideDisabled&&(this.disabled||"OPTGROUP"===this.parentElement.tagName&&this.parentElement.disabled))return;var e,i=t(this),o=i.data("icon")&&n.options.showIcon?'<i class="'+n.options.iconBase+" "+i.data("icon")+'"></i> ':"";return e=n.options.showSubtext&&i.data("subtext")&&!n.multiple?' <small class="text-muted">'+i.data("subtext")+"</small>":"","undefined"!=typeof i.attr("title")?i.attr("title"):i.data("content")&&n.options.showContent?i.data("content"):o+i.html()+e}}).toArray(),s=this.multiple?o.join(this.options.multipleSeparator):o[0];if(this.multiple&&this.options.selectedTextFormat.indexOf("count")>-1){var a=this.options.selectedTextFormat.split(">");if(a.length>1&&o.length>a[1]||1==a.length&&o.length>=2){i=this.options.hideDisabled?", [disabled]":"";var r=this.$element.find("option").not('[data-divider="true"], [data-hidden="true"]'+i).length,l="function"==typeof this.options.countSelectedText?this.options.countSelectedText(o.length,r):this.options.countSelectedText;s=l.replace("{0}",o.length.toString()).replace("{1}",r.toString())}}void 0==this.options.title&&(this.options.title=this.$element.attr("title")),"static"==this.options.selectedTextFormat&&(s=this.options.title),s||(s="undefined"!=typeof this.options.title?this.options.title:this.options.noneSelectedText),this.$button.attr("title",t.trim(s.replace(/<[^>]*>?/g,""))),this.$button.children(".filter-option").html(s),this.$element.trigger("rendered.bs.select")},setStyle:function(t,e){this.$element.attr("class")&&this.$newElement.addClass(this.$element.attr("class").replace(/selectpicker|mobile-device|bs-select-hidden|validate\[.*\]/gi,""));var i=t?t:this.options.style;"add"==e?this.$button.addClass(i):"remove"==e?this.$button.removeClass(i):(this.$button.removeClass(this.options.style),this.$button.addClass(i))},liHeight:function(e){if(e||this.options.size!==!1&&!this.sizeInfo){var i=document.createElement("div"),n=document.createElement("div"),o=document.createElement("ul"),s=document.createElement("li"),a=document.createElement("li"),r=document.createElement("a"),l=document.createElement("span"),d=this.options.header?this.$menu.find(".popover-title")[0].cloneNode(!0):null,c=this.options.liveSearch?document.createElement("div"):null,p=this.options.actionsBox&&this.multiple?this.$menu.find(".bs-actionsbox")[0].cloneNode(!0):null,h=this.options.doneButton&&this.multiple?this.$menu.find(".bs-donebutton")[0].cloneNode(!0):null;if(l.className="text",i.className=this.$menu[0].parentNode.className+" open",n.className="dropdown-menu open",o.className="dropdown-menu inner",s.className="divider",l.appendChild(document.createTextNode("Inner text")),r.appendChild(l),a.appendChild(r),o.appendChild(a),o.appendChild(s),d&&n.appendChild(d),c){var u=document.createElement("span");c.className="bs-searchbox",u.className="form-control",c.appendChild(u),n.appendChild(c)}p&&n.appendChild(p),n.appendChild(o),h&&n.appendChild(h),i.appendChild(n),document.body.appendChild(i);var f=r.offsetHeight,g=d?d.offsetHeight:0,m=c?c.offsetHeight:0,v=p?p.offsetHeight:0,b=h?h.offsetHeight:0,_=t(s).outerHeight(!0),w="function"==typeof getComputedStyle?getComputedStyle(n):!1,y=w?null:t(n),x=parseInt(w?w.paddingTop:y.css("paddingTop"))+parseInt(w?w.paddingBottom:y.css("paddingBottom"))+parseInt(w?w.borderTopWidth:y.css("borderTopWidth"))+parseInt(w?w.borderBottomWidth:y.css("borderBottomWidth")),$=x+parseInt(w?w.marginTop:y.css("marginTop"))+parseInt(w?w.marginBottom:y.css("marginBottom"))+2;document.body.removeChild(i),this.sizeInfo={liHeight:f,headerHeight:g,searchHeight:m,actionsHeight:v,doneButtonHeight:b,dividerHeight:_,menuPadding:x,menuExtras:$}}},setSize:function(){if(this.findLis(),this.liHeight(),this.options.header&&this.$menu.css("padding-top",0),this.options.size!==!1){var e,i,n,o,s=this,a=this.$menu,r=this.$menuInner,l=t(window),d=this.$newElement[0].offsetHeight,c=this.sizeInfo.liHeight,p=this.sizeInfo.headerHeight,h=this.sizeInfo.searchHeight,u=this.sizeInfo.actionsHeight,f=this.sizeInfo.doneButtonHeight,g=this.sizeInfo.dividerHeight,m=this.sizeInfo.menuPadding,v=this.sizeInfo.menuExtras,b=this.options.hideDisabled?".disabled":"",_=function(){n=s.$newElement.offset().top-l.scrollTop(),o=l.height()-n-d};if(_(),"auto"===this.options.size){var w=function(){var l,d=function(e,i){return function(n){return i?n.classList?n.classList.contains(e):t(n).hasClass(e):!(n.classList?n.classList.contains(e):t(n).hasClass(e))}},g=s.$menuInner[0].getElementsByTagName("li"),b=Array.prototype.filter?Array.prototype.filter.call(g,d("hidden",!1)):s.$lis.not(".hidden"),w=Array.prototype.filter?Array.prototype.filter.call(b,d("dropdown-header",!0)):b.filter(".dropdown-header");_(),e=o-v,s.options.container?(a.data("height")||a.data("height",a.height()),i=a.data("height")):i=a.height(),s.options.dropupAuto&&s.$newElement.toggleClass("dropup",n>o&&i>e-v),s.$newElement.hasClass("dropup")&&(e=n-v),l=b.length+w.length>3?3*c+v-2:0,a.css({"max-height":e+"px",overflow:"hidden","min-height":l+p+h+u+f+"px"}),r.css({"max-height":e-p-h-u-f-m+"px","overflow-y":"auto","min-height":Math.max(l-m,0)+"px"})};w(),this.$searchbox.off("input.getSize propertychange.getSize").on("input.getSize propertychange.getSize",w),l.off("resize.getSize scroll.getSize").on("resize.getSize scroll.getSize",w)}else if(this.options.size&&"auto"!=this.options.size&&this.$lis.not(b).length>this.options.size){var y=this.$lis.not(".divider").not(b).children().slice(0,this.options.size).last().parent().index(),x=this.$lis.slice(0,y+1).filter(".divider").length;e=c*this.options.size+x*g+m,s.options.container?(a.data("height")||a.data("height",a.height()),i=a.data("height")):i=a.height(),s.options.dropupAuto&&this.$newElement.toggleClass("dropup",n>o&&i>e-v),a.css({"max-height":e+p+h+u+f+"px",overflow:"hidden","min-height":""}),r.css({"max-height":e-m+"px","overflow-y":"auto","min-height":""})}}},setWidth:function(){if("auto"===this.options.width){this.$menu.css("min-width","0");var t=this.$menu.parent().clone().appendTo("body"),e=this.options.container?this.$newElement.clone().appendTo("body"):t,i=t.children(".dropdown-menu").outerWidth(),n=e.css("width","auto").children("button").outerWidth();t.remove(),e.remove(),this.$newElement.css("width",Math.max(i,n)+"px")}else"fit"===this.options.width?(this.$menu.css("min-width",""),this.$newElement.css("width","").addClass("fit-width")):this.options.width?(this.$menu.css("min-width",""),this.$newElement.css("width",this.options.width)):(this.$menu.css("min-width",""),this.$newElement.css("width",""));this.$newElement.hasClass("fit-width")&&"fit"!==this.options.width&&this.$newElement.removeClass("fit-width")},selectPosition:function(){var e,i,n=this,o=t('<div class="bs-container" />'),s=function(t){o.addClass(t.attr("class").replace(/form-control|fit-width/gi,"")).toggleClass("dropup",t.hasClass("dropup")),e=t.offset(),i=t.hasClass("dropup")?0:t[0].offsetHeight,o.css({top:e.top+i,left:e.left,width:t[0].offsetWidth})};this.$newElement.on("click",function(){n.isDisabled()||(s(t(this)),o.appendTo(n.options.container),o.toggleClass("open",!t(this).hasClass("open")),o.append(n.$menu))}),t(window).on("resize scroll",function(){s(n.$newElement)}),this.$element.on("hide.bs.select",function(){n.$menu.data("height",n.$menu.height()),o.detach()})},setSelected:function(t,e,i){if(!i)var i=this.findLis().eq(this.liObj[t]);i.toggleClass("selected",e)},setDisabled:function(t,e,i){if(!i)var i=this.findLis().eq(this.liObj[t]);e?i.addClass("disabled").children("a").attr("href","#").attr("tabindex",-1):i.removeClass("disabled").children("a").removeAttr("href").attr("tabindex",0)},isDisabled:function(){return this.$element[0].disabled},checkDisabled:function(){var t=this;this.isDisabled()?(this.$newElement.addClass("disabled"),this.$button.addClass("disabled").attr("tabindex",-1)):(this.$button.hasClass("disabled")&&(this.$newElement.removeClass("disabled"),this.$button.removeClass("disabled")),-1!=this.$button.attr("tabindex")||this.$element.data("tabindex")||this.$button.removeAttr("tabindex")),this.$button.click(function(){return!t.isDisabled()})},tabIndex:function(){this.$element.is("[tabindex]")&&(this.$element.data("tabindex",this.$element.attr("tabindex")),this.$button.attr("tabindex",this.$element.data("tabindex")))},clickListener:function(){var e=this,i=t(document);this.$newElement.on("touchstart.dropdown",".dropdown-menu",function(t){t.stopPropagation()}),i.data("spaceSelect",!1),this.$button.on("keyup",function(t){/(32)/.test(t.keyCode.toString(10))&&i.data("spaceSelect")&&(t.preventDefault(),i.data("spaceSelect",!1))}),this.$newElement.on("click",function(){e.setSize(),e.$element.on("shown.bs.select",function(){if(e.options.liveSearch||e.multiple){if(!e.multiple){var t=e.liObj[e.$element[0].selectedIndex];if("number"!=typeof t||e.options.size===!1)return;var i=e.$lis.eq(t)[0].offsetTop-e.$menuInner[0].offsetTop;i=i-e.$menuInner[0].offsetHeight/2+e.sizeInfo.liHeight/2,e.$menuInner[0].scrollTop=i}}else e.$menuInner.find(".selected a").focus()})}),this.$menuInner.on("click","li a",function(i){var n=t(this),o=n.parent().data("originalIndex"),s=e.$element.val(),a=e.$element.prop("selectedIndex");if(e.multiple&&i.stopPropagation(),i.preventDefault(),!e.isDisabled()&&!n.parent().hasClass("disabled")){var r=e.$element.find("option"),l=r.eq(o),d=l.prop("selected"),c=l.parent("optgroup"),p=e.options.maxOptions,h=c.data("maxOptions")||!1;if(e.multiple){if(l.prop("selected",!d),e.setSelected(o,!d),n.blur(),p!==!1||h!==!1){var u=p<r.filter(":selected").length,f=h<c.find("option:selected").length;if(p&&u||h&&f)if(p&&1==p)r.prop("selected",!1),l.prop("selected",!0),e.$menuInner.find(".selected").removeClass("selected"),e.setSelected(o,!0);else if(h&&1==h){c.find("option:selected").prop("selected",!1),l.prop("selected",!0);var g=n.parent().data("optgroup");e.$menuInner.find('[data-optgroup="'+g+'"]').removeClass("selected"),e.setSelected(o,!0)}else{var m="function"==typeof e.options.maxOptionsText?e.options.maxOptionsText(p,h):e.options.maxOptionsText,v=m[0].replace("{n}",p),b=m[1].replace("{n}",h),_=t('<div class="notify"></div>');m[2]&&(v=v.replace("{var}",m[2][p>1?0:1]),b=b.replace("{var}",m[2][h>1?0:1])),l.prop("selected",!1),e.$menu.append(_),p&&u&&(_.append(t("<div>"+v+"</div>")),e.$element.trigger("maxReached.bs.select")),h&&f&&(_.append(t("<div>"+b+"</div>")),e.$element.trigger("maxReachedGrp.bs.select")),setTimeout(function(){e.setSelected(o,!1)},10),_.delay(750).fadeOut(300,function(){t(this).remove()})}}}else r.prop("selected",!1),l.prop("selected",!0),e.$menuInner.find(".selected").removeClass("selected"),e.setSelected(o,!0);e.multiple?e.options.liveSearch&&e.$searchbox.focus():e.$button.focus(),(s!=e.$element.val()&&e.multiple||a!=e.$element.prop("selectedIndex")&&!e.multiple)&&(e.$element.triggerNative("change"),e.$element.trigger("changed.bs.select",[o,l.prop("selected"),d]))}}),this.$menu.on("click","li.disabled a, .popover-title, .popover-title :not(.close)",function(i){i.currentTarget==this&&(i.preventDefault(),i.stopPropagation(),e.options.liveSearch&&!t(i.target).hasClass("close")?e.$searchbox.focus():e.$button.focus())}),this.$menuInner.on("click",".divider, .dropdown-header",function(t){t.preventDefault(),t.stopPropagation(),e.options.liveSearch?e.$searchbox.focus():e.$button.focus()}),this.$menu.on("click",".popover-title .close",function(){e.$button.click()}),this.$searchbox.on("click",function(t){t.stopPropagation()}),this.$menu.on("click",".actions-btn",function(i){e.options.liveSearch?e.$searchbox.focus():e.$button.focus(),i.preventDefault(),i.stopPropagation(),t(this).hasClass("bs-select-all")?e.selectAll():e.deselectAll(),e.$element.triggerNative("change")}),this.$element.change(function(){e.render(!1)})},liveSearchListener:function(){var n=this,o=t('<li class="no-results"></li>');this.$newElement.on("click.dropdown.data-api touchstart.dropdown.data-api",function(){n.$menuInner.find(".active").removeClass("active"),n.$searchbox.val()&&(n.$searchbox.val(""),n.$lis.not(".is-hidden").removeClass("hidden"),o.parent().length&&o.remove()),n.multiple||n.$menuInner.find(".selected").addClass("active"),setTimeout(function(){n.$searchbox.focus()},10)}),this.$searchbox.on("click.dropdown.data-api focus.dropdown.data-api touchend.dropdown.data-api",function(t){t.stopPropagation()}),this.$searchbox.on("input propertychange",function(){if(n.$searchbox.val()){var s=n.$lis.not(".is-hidden").removeClass("hidden").children("a");s=s.not(n.options.liveSearchNormalize?":a"+n._searchStyle()+'("'+e(n.$searchbox.val())+'")':":"+n._searchStyle()+'("'+n.$searchbox.val()+'")'),s.parent().addClass("hidden"),n.$lis.filter(".dropdown-header").each(function(){var e=t(this),i=e.data("optgroup");0===n.$lis.filter("[data-optgroup="+i+"]").not(e).not(".hidden").length&&(e.addClass("hidden"),n.$lis.filter("[data-optgroup="+i+"div]").addClass("hidden"))});var a=n.$lis.not(".hidden");a.each(function(e){var i=t(this);i.hasClass("divider")&&(i.index()===a.first().index()||i.index()===a.last().index()||a.eq(e+1).hasClass("divider"))&&i.addClass("hidden")}),n.$lis.not(".hidden, .no-results").length?o.parent().length&&o.remove():(o.parent().length&&o.remove(),o.html(n.options.noneResultsText.replace("{0}",'"'+i(n.$searchbox.val())+'"')).show(),n.$menuInner.append(o))}else n.$lis.not(".is-hidden").removeClass("hidden"),o.parent().length&&o.remove();n.$lis.filter(".active").removeClass("active"),n.$searchbox.val()&&n.$lis.not(".hidden, .divider, .dropdown-header").eq(0).addClass("active").children("a").focus(),t(this).focus()})},_searchStyle:function(){var t="icontains";switch(this.options.liveSearchStyle){case"begins":case"startsWith":t="ibegins";break;case"contains":}return t},val:function(t){return"undefined"!=typeof t?(this.$element.val(t),this.render(),this.$element):this.$element.val()},selectAll:function(){this.findLis(),this.$element.find("option:enabled").not("[data-divider], [data-hidden]").prop("selected",!0),this.$lis.not(".divider, .dropdown-header, .disabled, .hidden").addClass("selected"),this.render(!1)},deselectAll:function(){this.findLis(),this.$element.find("option:enabled").not("[data-divider], [data-hidden]").prop("selected",!1),this.$lis.not(".divider, .dropdown-header, .disabled, .hidden").removeClass("selected"),this.render(!1)},keydown:function(i){var n,o,s,a,r,l,d,c,p,h=t(this),u=h.is("input")?h.parent().parent():h.parent(),f=u.data("this"),g=":not(.disabled, .hidden, .dropdown-header, .divider)",m={32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"};if(f.options.liveSearch&&(u=h.parent().parent()),f.options.container&&(u=f.$menu),n=t(".dropdown-menu.inner li",u),p=f.$menu.parent().hasClass("open"),!p&&(i.keyCode>=48&&i.keyCode<=57||i.keyCode>=65&&i.keyCode<=90)&&(f.options.container?f.$newElement.trigger("click"):(f.setSize(),f.$menu.parent().addClass("open"),p=!0),f.$searchbox.focus()),f.options.liveSearch&&(/(^9$|27)/.test(i.keyCode.toString(10))&&p&&0===f.$menu.find(".active").length&&(i.preventDefault(),f.$menu.parent().removeClass("open"),f.options.container&&f.$newElement.removeClass("open"),f.$button.focus()),n=t(".dropdown-menu.inner li"+g,u),h.val()||/(38|40)/.test(i.keyCode.toString(10))||0===n.filter(".active").length&&(n=f.$menuInner.find("li"),n=n.filter(f.options.liveSearchNormalize?":a"+f._searchStyle()+"("+e(m[i.keyCode])+")":":"+f._searchStyle()+"("+m[i.keyCode]+")"))),n.length){if(/(38|40)/.test(i.keyCode.toString(10)))o=n.index(n.find("a").filter(":focus").parent()),a=n.filter(g).first().index(),r=n.filter(g).last().index(),s=n.eq(o).nextAll(g).eq(0).index(),l=n.eq(o).prevAll(g).eq(0).index(),d=n.eq(s).prevAll(g).eq(0).index(),f.options.liveSearch&&(n.each(function(e){t(this).hasClass("disabled")||t(this).data("index",e)}),o=n.index(n.filter(".active")),a=n.first().data("index"),r=n.last().data("index"),s=n.eq(o).nextAll().eq(0).data("index"),l=n.eq(o).prevAll().eq(0).data("index"),d=n.eq(s).prevAll().eq(0).data("index")),c=h.data("prevIndex"),38==i.keyCode?(f.options.liveSearch&&o--,o!=d&&o>l&&(o=l),a>o&&(o=a),o==c&&(o=r)):40==i.keyCode&&(f.options.liveSearch&&o++,-1==o&&(o=0),o!=d&&s>o&&(o=s),o>r&&(o=r),o==c&&(o=a)),h.data("prevIndex",o),f.options.liveSearch?(i.preventDefault(),h.hasClass("dropdown-toggle")||(n.removeClass("active").eq(o).addClass("active").children("a").focus(),h.focus())):n.eq(o).children("a").focus();else if(!h.is("input")){var v,b,_=[];n.each(function(){t(this).hasClass("disabled")||t.trim(t(this).children("a").text().toLowerCase()).substring(0,1)==m[i.keyCode]&&_.push(t(this).index())}),v=t(document).data("keycount"),v++,t(document).data("keycount",v),b=t.trim(t(":focus").text().toLowerCase()).substring(0,1),b!=m[i.keyCode]?(v=1,t(document).data("keycount",v)):v>=_.length&&(t(document).data("keycount",0),v>_.length&&(v=1)),n.eq(_[v-1]).children("a").focus()}if((/(13|32)/.test(i.keyCode.toString(10))||/(^9$)/.test(i.keyCode.toString(10))&&f.options.selectOnTab)&&p){if(/(32)/.test(i.keyCode.toString(10))||i.preventDefault(),f.options.liveSearch)/(32)/.test(i.keyCode.toString(10))||(f.$menuInner.find(".active a").click(),h.focus());else{var w=t(":focus");w.click(),w.focus(),i.preventDefault(),t(document).data("spaceSelect",!0)}t(document).data("keycount",0)}(/(^9$|27)/.test(i.keyCode.toString(10))&&p&&(f.multiple||f.options.liveSearch)||/(27)/.test(i.keyCode.toString(10))&&!p)&&(f.$menu.parent().removeClass("open"),f.options.container&&f.$newElement.removeClass("open"),f.$button.focus())}},mobile:function(){this.$element.addClass("mobile-device").appendTo(this.$newElement),this.options.container&&this.$menu.hide()},refresh:function(){this.$lis=null,this.liObj={},this.reloadLi(),this.render(),this.checkDisabled(),this.liHeight(!0),this.setStyle(),this.setWidth(),this.$lis&&this.$searchbox.trigger("propertychange"),this.$element.trigger("refreshed.bs.select")},hide:function(){this.$newElement.hide()},show:function(){this.$newElement.show()},remove:function(){this.$newElement.remove(),this.$element.remove()}};var s=t.fn.selectpicker;t.fn.selectpicker=n,t.fn.selectpicker.Constructor=o,t.fn.selectpicker.noConflict=function(){return t.fn.selectpicker=s,this},t(document).data("keycount",0).on("keydown",".bootstrap-select [data-toggle=dropdown], .bootstrap-select .dropdown-menu.inner, .bs-searchbox input",o.prototype.keydown).on("focusin.modal",".bootstrap-select [data-toggle=dropdown], .bootstrap-select .dropdown-menu.inner, .bs-searchbox input",function(t){t.stopPropagation()}),t(window).on("load.bs.select.data-api",function(){t(".selectpicker").each(function(){var e=t(this);n.call(e,e.data())})})}(jQuery),function(t){t.cookie=function(e,i,n){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(i))||null===i||void 0===i)){if(n=t.extend({},n),(null===i||void 0===i)&&(n.expires=-1),"number"==typeof n.expires){var o=n.expires,s=n.expires=new Date;s.setDate(s.getDate()+o)}return i=String(i),document.cookie=[encodeURIComponent(e),"=",n.raw?i:encodeURIComponent(i),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}n=i||{};for(var a,r=n.raw?function(t){return t}:decodeURIComponent,l=document.cookie.split("; "),d=0;a=l[d]&&l[d].split("=");d++)if(r(a[0])===e)return r(a[1]||"");return null}}(jQuery),window.onload=function(){var t=parent;$(".insert_title_code").bind("click",function(){var e=[$(this).attr("bib_id"),$(this).attr("bib_title")];t.postMessage(e,domain_target_secure)})},function(t){var e,n,o,s,a,r,l,d,c,p,h=new Array,u=new Array,f={init:function(i){return this.each(function(){c=i,s=t(this),e=t(this).find(".carousel"),a=s.find("select"),r=e.find(".navButton_right"),l=e.find(".navButton_left"),d=e.find("img.lazy");var h={start_position:2,width:e.find(".viewer").width(),ul_obj:e.find("ul"),padding:9,speed:200,info_partial:null,img_height:135,controller:"dashboard/slider_list",list_type:"recently_reviewed_bibs",make_circular:!0,pointer_arrow:!1,text_list:!0,disable_ajax_load:!1,callback:!1};n=t.extend(h,i),p=d.size();var u=d.size();if(s.find("form select").attr("disabled","disabled"),t(".js_ada_switch").enterkey(13,function(){setTimeout(function(){t(".carouselContainer .viewSelector .view-small").click(),t(".carouselContainer .listView .listItem a").first().focus()},200)}),isNaN(n.start_position)&&u>5)n.start_position=Math.floor(u/2),start=n.start_position-2,end=n.start_position+2;else if(u>=5)u-1<n.start_position&&(n.start_position=d.size()-1),start=n.start_position-2>0?n.start_position-2:0,end=n.start_position+2<u-1?n.start_position+2:u-1;
else{if(0==u)return a.removeAttr("disabled"),void a.bind("change.carousel",f.switch_formats);start=0,end=u-1,n.start_position=Math.floor(u/2),n.make_circular=!1}if(o=n.start_position,1==n.disable_ajax_load)f.slide(n.start_position,5*n.speed,!0),r.bind("click.carousel",function(){f.make_circular("right")}),l.bind("click.carousel",function(){f.make_circular("left")});else if(f.load_images(start,end,!0),r.bind("click.carousel",function(){f.slide("right")}),l.bind("click.carousel",function(){f.slide("left")}),n.pointer_arrow){var g;t("li.carousel_item").hover(function(){var e=t(this).index();g=window.setInterval(function(t){f.slide(t),window.clearInterval(g)},600,e)},function(){window.clearInterval(g)})}})},switch_formats:function(){filters=s.find("form select, input#f_on_order").not('select[value*="any"]').serialize();var i=s.find('input[name="bib"]').attr("value");f.destroy(),t.cookie("back_to",baseURL()+document.location.pathname+"?view=VIEWCOVERS&bib="+i+"&format_html=true&"+filters,{path:"/"}),t.get(baseURL()+"/"+n.controller+"/"+n.list_type+".partial?view=VIEWCOVERS&bib="+i+"&"+filters,function(o){e.html(o.html),-1==o.html.indexOf("no_items")?(o.filters_html?(s.find(".widget_filters").html(o.filters_html),a=s.find("select")):a.removeAttr("disabled"),s.carousel(c)):(o.filters_html?(s.find(".widget_filters").html(o.filters_html),a=s.find("select"),a.on("change.carousel",f.switch_formats)):a.removeAttr("disabled"),s.carousel(c)),1==n.text_list&&t.get(baseURL()+"/dashboard/slider_list/"+n.list_type+".partial?view=VIEWLIST&bib="+i+"&"+filters,function(e){t("div.listView").html(e.html)})})},get_this_position:function(e){var i=0;return d.each(function(){t("img.lazy").index(t(this))<=e&&(i=i+t(this).width()+2*n.padding)}),i},load_images:function(t,e,s){function a(t){"object"==typeof u[t]&&(h[t].attr("src","//cor-cdn-static.bibliocommons.com/assets/default_covers/icon-book-93409e4decdf10c55296c91a97ac2653.png").removeAttr("imagedata").removeAttr("fallback").attr("width","96px").siblings(".lazy_loader").remove(),delete u[t]),l(t)}function r(t){"object"==typeof u[t]&&(u[t].width<20?(h[t].attr("src","//cor-cdn-static.bibliocommons.com/assets/default_covers/icon-book-93409e4decdf10c55296c91a97ac2653.png").removeAttr("imagedata").removeAttr("fallback").attr("width","96px").siblings(".lazy_loader").remove(),delete u[t]):(h[t].attr("src",u[t].src).addClass(h[t].attr("imagesize")).removeAttr("imagedata").removeAttr("fallback").attr("width",Math.round(n.img_height/u[t].height*u[t].width)+"px").siblings(".lazy_loader").remove(),delete u[t])),l(t)}function l(t){t==e&&(1==s?(f.slide(n.start_position,5*n.speed,!0),setTimeout(f.load_remaining_images,5*n.speed)):t==e&&f.align(o))}for(i=t;e>=i;i++)h[i]=d.eq(i),"true"!=h[i].attr("bumper")?"undefined"!=h[i].attr("imagedata")&&(u[i]=new Image,u[i].onerror=function(t){return function(){a(t)}}(i),u[i].onabort=function(t){return function(){a(t)}}(i),u[i].onload=function(t){return function(){r(t)}}(i),u[i].src=h[i].attr("imagedata")):!function(t){l(t)}(i)},load_queue:function(){t.each(u,function(t){h[t]&&u[t]&&h[t].attr("src",u[t].src).removeAttr("imagedata").removeAttr("fallback").attr("width",Math.round(135/u[t].height*u[t].width)+"px").siblings(".lazy_loader").remove()}),f.slide(o,0,!1)},align:function(t){var e=f.calculate_movement(t);n.ul_obj.css("left",e)},calculate_movement:function(t){var i=e.find("li.carousel_item").eq(t),o=f.get_this_position(t),s=-1*Math.round(o-(i.width()/2+n.padding)-n.width/2);return s+=0>s?"px":"px"},slide:function(i,s){if(s||(s=n.speed),isNaN(i)?"left"==i?i=o-1:"right"==i&&(i=o+1):i||0==i||(i=i=o+1),i>=0&&i<=e.find("li.carousel_item").size()-1){var a=e.find("li.carousel_item").eq(i),r=f.calculate_movement(i);if(n.pointer_arrow){var l=360-(a.width()/2-24);t(".bibInfoBlock .slider_pointer").animate({left:l},s)}n.ul_obj.animate({left:r},s,function(){a.find("img").addClass("current"),t(".container li").not(a).find("img").removeClass("current"),o=i,f.show_info(a),n.callback&&n.callback(a)})}},make_circular:function(t){if("left"==t?(go_to=o-1,t=-1):"right"==t&&(go_to=o+1,t=1),0>t)var i=go_to-2;else var i=go_to+3;if(i>0&&i<e.find("li.carousel_item").size())f.slide(go_to);else if(3>go_to){var s=(e.find("li.carousel_item").eq(i),e.find("li.carousel_item").last());s.remove(),s.prependTo(n.ul_obj),go_to+=1,f.slide(go_to)}else{var s=e.find("li.carousel_item").first();s.remove(),s.appendTo(n.ul_obj),go_to-=1,f.slide(go_to)}},start_to_end_slide:function(t){"left"==t?(go_to=o-1,t=-1):"right"==t&&(go_to=o+1,t=1);var i=e.find("li.carousel_item").size();f.slide(0>go_to?i-1:go_to>=i?0:go_to)},show_info:function(e){var i=e.attr("param");t(".carouselContainer .bibInfoBlock div").hide().removeAttr("testid"),t(".carouselContainer .bibInfoBlock").find(".info_"+i).show().attr("testid","current_info_block")},load_remaining_images:function(){function e(){g--,0>=g&&clearInterval(i),n.start_position+h<=c&&(f.load_images(n.start_position+h,n.start_position+h),h++),n.start_position+u>=0&&(f.load_images(n.start_position+u,n.start_position+u),u--),n.start_position+h>c&&n.start_position+u<0&&(r.unbind("click.carousel"),l.unbind("click.carousel"),1==n.make_circular?(r.bind("click.carousel",function(){f.make_circular("right")}),l.bind("click.carousel",function(){f.make_circular("left")})):(r.bind("click.carousel",function(){f.start_to_end_slide("right")}),l.bind("click.carousel",function(){f.start_to_end_slide("left")})),s.find(".view-medium").bind("click.carousel",function(){setTimeout(function(){f.slide(o)},100)}),a.removeAttr("disabled"),a.bind("change.carousel",f.switch_formats),n.ul_obj.find(".item_bumper")&&n.ul_obj.find(".item_bumper").bind("click.carousel",function(){s.find('input[name="bib"]').attr("value",t(this).attr("id").replace("bib_","")),f.switch_formats()}),clearInterval(i))}var i=setInterval(e,100),c=d.size()-1,h=3,u=-3,g=p-6},destroy:function(){a.unbind("change.carousel"),r.unbind("click.carousel"),l.unbind("click.carousel"),h.length=0,u.length=0,a.attr("disabled","disabled"),s.find(".view-medium").unbind("click.carousel"),n.ul_obj.find(".item_bumper")&&n.ul_obj.find(".item_bumper").unbind("click.carousel")},lite_load:function(){filters=s.find("form select, input#f_on_order").serialize();var i=s.find('input[name="bib"]').attr("value");f.destroy(),t.cookie("back_to",baseURL()+document.location.pathname+"?view=VIEWCOVERS&bib="+i+"&format_html=true&"+filters,{path:"/"}),t.get(baseURL()+"/"+n.controller+"/"+n.list_type+".partial?view=VIEWCOVERS&bib="+i+"&"+filters,function(o){e.html(o.html),-1==o.html.indexOf("no_items")?(o.filters_html?(s.find(".widget_filters").html(o.filters_html),a=s.find("select")):a.removeAttr("disabled"),s.carousel(c)):(o.filters_html?(s.find(".widget_filters").html(o.filters_html),a=s.find("select"),a.on("change.carousel",f.switch_formats)):a.removeAttr("disabled"),s.carousel(c)),1==n.text_list&&t.get(baseURL()+"/dashboard/slider_list/"+n.list_type+".partial?view=VIEWLIST&bib="+i+"&"+filters,function(e){t("div.listView").html(e.html)})})}};t.fn.carousel=function(t){return f[t]?f[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void 0:f.init.apply(this,arguments)}}(jQuery),/**
 * bxSlider v4.2.7
 * Copyright 2013-2016 Steven Wanderski
 * Written while drinking Belgian ales and listening to jazz

 * Licensed under MIT (http://opensource.org/licenses/MIT)
 */
function(t){var e={mode:"horizontal",slideSelector:"",infiniteLoop:!1,hideControlOnEnd:!1,speed:500,easing:null,slideMargin:0,startSlide:0,randomStart:!1,captions:!1,ticker:!1,tickerHover:!1,adaptiveHeight:!1,adaptiveHeightSpeed:500,video:!1,useCSS:!0,preloadImages:"visible",responsive:!0,slideZIndex:50,wrapperClass:"bx-wrapper",touchEnabled:!0,swipeThreshold:50,oneToOneTouch:!0,preventDefaultSwipeX:!0,preventDefaultSwipeY:!1,ariaLive:!0,ariaHidden:!0,keyboardEnabled:!1,pager:!0,pagerType:"full",pagerShortSeparator:" / ",pagerSelector:null,buildPager:null,pagerCustom:null,controls:!0,nextText:"Next",prevText:"Prev",nextSelector:null,prevSelector:null,autoControls:!1,startText:"Start",stopText:"Stop",autoControlsCombine:!1,autoControlsSelector:null,auto:!1,pause:4e3,autoStart:!0,autoDirection:"next",stopAutoOnClick:!1,autoHover:!1,autoDelay:0,autoSlideForOnePage:!1,minSlides:1,maxSlides:1,moveSlides:0,slideWidth:0,shrinkItems:!1,onSliderLoad:function(){return!0},onSlideBefore:function(){return!0},onSlideAfter:function(){return!0},onSlideNext:function(){return!0},onSlidePrev:function(){return!0},onSliderResize:function(){return!0}};t.fn.bxSlider=function(n){if(0===this.length)return this;if(this.length>1)return this.each(function(){t(this).bxSlider(n)}),this;var o={},s=this,a=t(window).width(),r=t(window).height();if(!t(s).data("bxSlider")){var l=function(){t(s).data("bxSlider")||(o.settings=t.extend({},e,n),o.settings.slideWidth=parseInt(o.settings.slideWidth),o.children=s.children(o.settings.slideSelector),o.children.length<o.settings.minSlides&&(o.settings.minSlides=o.children.length),o.children.length<o.settings.maxSlides&&(o.settings.maxSlides=o.children.length),o.settings.randomStart&&(o.settings.startSlide=Math.floor(Math.random()*o.children.length)),o.active={index:o.settings.startSlide},o.carousel=o.settings.minSlides>1||o.settings.maxSlides>1?!0:!1,o.carousel&&(o.settings.preloadImages="all"),o.minThreshold=o.settings.minSlides*o.settings.slideWidth+(o.settings.minSlides-1)*o.settings.slideMargin,o.maxThreshold=o.settings.maxSlides*o.settings.slideWidth+(o.settings.maxSlides-1)*o.settings.slideMargin,o.working=!1,o.controls={},o.interval=null,o.animProp="vertical"===o.settings.mode?"top":"left",o.usingCSS=o.settings.useCSS&&"fade"!==o.settings.mode&&function(){for(var t=document.createElement("div"),e=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"],i=0;i<e.length;i++)if(void 0!==t.style[e[i]])return o.cssPrefix=e[i].replace("Perspective","").toLowerCase(),o.animProp="-"+o.cssPrefix+"-transform",!0;return!1}(),"vertical"===o.settings.mode&&(o.settings.maxSlides=o.settings.minSlides),s.data("origStyle",s.attr("style")),s.children(o.settings.slideSelector).each(function(){t(this).data("origStyle",t(this).attr("style"))}),d())},d=function(){var e=o.children.eq(o.settings.startSlide);s.wrap('<div class="'+o.settings.wrapperClass+'"><div class="bx-viewport"></div></div>'),o.viewport=s.parent(),o.settings.ariaLive&&!o.settings.ticker&&o.viewport.attr("aria-live","polite"),o.loader=t('<div class="bx-loading" />'),o.viewport.prepend(o.loader),s.css({width:"horizontal"===o.settings.mode?1e3*o.children.length+215+"%":"auto",position:"relative"}),o.usingCSS&&o.settings.easing?s.css("-"+o.cssPrefix+"-transition-timing-function",o.settings.easing):o.settings.easing||(o.settings.easing="swing"),o.viewport.css({width:"100%",overflow:"hidden",position:"relative"}),o.viewport.parent().css({maxWidth:u()}),o.settings.pager||o.settings.controls||o.viewport.parent().css({margin:"0 auto 0px"}),o.children.css({"float":"horizontal"===o.settings.mode?"left":"none",listStyle:"none",position:"relative"}),o.children.css("width",f()),"horizontal"===o.settings.mode&&o.settings.slideMargin>0&&o.children.css("marginRight",o.settings.slideMargin),"vertical"===o.settings.mode&&o.settings.slideMargin>0&&o.children.css("marginBottom",o.settings.slideMargin),"fade"===o.settings.mode&&(o.children.css({position:"absolute",zIndex:0,display:"none"}),o.children.eq(o.settings.startSlide).css({zIndex:o.settings.slideZIndex,display:"block"})),o.controls.el=t('<div class="bx-controls" />'),o.settings.captions&&C(),o.active.last=o.settings.startSlide===m()-1,o.settings.video&&s.fitVids(),("all"===o.settings.preloadImages||o.settings.ticker)&&(e=o.children),o.settings.ticker?o.settings.pager=!1:(o.settings.controls&&x(),o.settings.auto&&o.settings.autoControls&&$(),o.settings.pager&&y(),(o.settings.controls||o.settings.autoControls||o.settings.pager)&&o.viewport.after(o.controls.el)),c(e,p)},c=function(e,i){var n=e.find('img:not([src=""]), iframe').length,o=0;return 0===n?void i():void e.find('img:not([src=""]), iframe').each(function(){t(this).one("load error",function(){++o===n&&i()}).each(function(){this.complete&&t(this).load()})})},p=function(){if(o.settings.infiniteLoop&&"fade"!==o.settings.mode&&!o.settings.ticker){var e="vertical"===o.settings.mode?o.settings.minSlides:o.settings.maxSlides,i=o.children.slice(0,e).clone(!0).addClass("bx-clone"),n=o.children.slice(-e).clone(!0).addClass("bx-clone");o.settings.ariaHidden&&(i.attr("aria-hidden",!0),n.attr("aria-hidden",!0)),s.append(i).prepend(n)}o.loader.remove(),b(),"vertical"===o.settings.mode&&(o.settings.adaptiveHeight=!0),o.viewport.height(h()),s.redrawSlider(),o.settings.onSliderLoad.call(s,o.active.index),o.initialized=!0,o.settings.responsive&&t(window).bind("resize",W),o.settings.auto&&o.settings.autoStart&&(m()>1||o.settings.autoSlideForOnePage)&&O(),o.settings.ticker&&M(),o.settings.pager&&A(o.settings.startSlide),o.settings.controls&&D(),o.settings.touchEnabled&&!o.settings.ticker&&N(),o.settings.keyboardEnabled&&!o.settings.ticker&&t(document).keydown(q)},h=function(){var e=0,n=t();if("vertical"===o.settings.mode||o.settings.adaptiveHeight)if(o.carousel){var s=1===o.settings.moveSlides?o.active.index:o.active.index*v();for(n=o.children.eq(s),i=1;i<=o.settings.maxSlides-1;i++)n=n.add(s+i>=o.children.length?o.children.eq(i-1):o.children.eq(s+i))}else n=o.children.eq(o.active.index);else n=o.children;return"vertical"===o.settings.mode?(n.each(function(){e+=t(this).outerHeight()}),o.settings.slideMargin>0&&(e+=o.settings.slideMargin*(o.settings.minSlides-1))):e=Math.max.apply(Math,n.map(function(){return t(this).outerHeight(!1)}).get()),"border-box"===o.viewport.css("box-sizing")?e+=parseFloat(o.viewport.css("padding-top"))+parseFloat(o.viewport.css("padding-bottom"))+parseFloat(o.viewport.css("border-top-width"))+parseFloat(o.viewport.css("border-bottom-width")):"padding-box"===o.viewport.css("box-sizing")&&(e+=parseFloat(o.viewport.css("padding-top"))+parseFloat(o.viewport.css("padding-bottom"))),e},u=function(){var t="100%";return o.settings.slideWidth>0&&(t="horizontal"===o.settings.mode?o.settings.maxSlides*o.settings.slideWidth+(o.settings.maxSlides-1)*o.settings.slideMargin:o.settings.slideWidth),t},f=function(){var t=o.settings.slideWidth,e=o.viewport.width();if(0===o.settings.slideWidth||o.settings.slideWidth>e&&!o.carousel||"vertical"===o.settings.mode)t=e;else if(o.settings.maxSlides>1&&"horizontal"===o.settings.mode){if(e>o.maxThreshold)return t;e<o.minThreshold?t=(e-o.settings.slideMargin*(o.settings.minSlides-1))/o.settings.minSlides:o.settings.shrinkItems&&(t=Math.floor((e+o.settings.slideMargin)/Math.ceil((e+o.settings.slideMargin)/(t+o.settings.slideMargin))-o.settings.slideMargin))}return t||o.settings.slideWidth},g=function(){var t=1,e=null;return"horizontal"===o.settings.mode&&o.settings.slideWidth>0?o.viewport.width()<o.minThreshold?t=o.settings.minSlides:o.viewport.width()>o.maxThreshold?t=o.settings.maxSlides:(e=o.children.first().outerWidth()+o.settings.slideMargin,t=Math.floor((o.viewport.width()+o.settings.slideMargin)/e)):"vertical"===o.settings.mode&&(t=o.settings.minSlides),t},m=function(){var t=0,e=0,i=0;if(o.settings.moveSlides>0)if(o.settings.infiniteLoop)t=Math.ceil(o.children.length/v());else for(;e<o.children.length;)++t,e=i+g(),i+=o.settings.moveSlides<=g()?o.settings.moveSlides:g();else t=Math.ceil(o.children.length/g());return t},v=function(){return o.settings.moveSlides>0&&o.settings.moveSlides<=g()?o.settings.moveSlides:g()},b=function(){var t,e,i;o.children.length>o.settings.maxSlides&&o.active.last&&!o.settings.infiniteLoop?"horizontal"===o.settings.mode?(e=o.children.last(),t=e.position(),_(-(t.left-(o.viewport.width()-e.outerWidth())),"reset",0)):"vertical"===o.settings.mode&&(i=o.children.length-o.settings.minSlides,t=o.children.eq(i).position(),_(-t.top,"reset",0)):(t=o.children.eq(o.active.index*v()).position(),o.active.index===m()-1&&(o.active.last=!0),void 0!==t&&null!==t&&("horizontal"===o.settings.mode?_(-t.left,"reset",0):"vertical"===o.settings.mode&&_(-t.top,"reset",0)))},_=function(e,i,n,a){var r,l;o.usingCSS?(l="vertical"===o.settings.mode?"translate3d(0, "+e+"px, 0)":"translate3d("+e+"px, 0, 0)",s.css("-"+o.cssPrefix+"-transition-duration",n/1e3+"s"),"slide"===i?(s.css(o.animProp,l),0!==n?s.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(e){t(e.target).is(s)&&(s.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),I())}):I()):"reset"===i?s.css(o.animProp,l):"ticker"===i&&(s.css("-"+o.cssPrefix+"-transition-timing-function","linear"),s.css(o.animProp,l),0!==n?s.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(e){t(e.target).is(s)&&(s.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),_(a.resetValue,"reset",0),z())}):(_(a.resetValue,"reset",0),z()))):(r={},r[o.animProp]=e,"slide"===i?s.animate(r,n,o.settings.easing,function(){I()}):"reset"===i?s.css(o.animProp,e):"ticker"===i&&s.animate(r,n,"linear",function(){_(a.resetValue,"reset",0),z()}))},w=function(){for(var e="",i="",n=m(),s=0;n>s;s++)i="",o.settings.buildPager&&t.isFunction(o.settings.buildPager)||o.settings.pagerCustom?(i=o.settings.buildPager(s),o.pagerEl.addClass("bx-custom-pager")):(i=s+1,o.pagerEl.addClass("bx-default-pager")),e+='<div class="bx-pager-item"><a href="" data-slide-index="'+s+'" class="bx-pager-link">'+i+"</a></div>";o.pagerEl.html(e)},y=function(){o.settings.pagerCustom?o.pagerEl=t(o.settings.pagerCustom):(o.pagerEl=t('<div class="bx-pager" />'),o.settings.pagerSelector?t(o.settings.pagerSelector).html(o.pagerEl):o.controls.el.addClass("bx-has-pager").append(o.pagerEl),w()),o.pagerEl.on("click touchend","a",j)},x=function(){o.controls.next=t('<a class="bx-next" href="">'+o.settings.nextText+"</a>"),o.controls.prev=t('<a class="bx-prev" href="">'+o.settings.prevText+"</a>"),o.controls.next.bind("click touchend",S),o.controls.prev.bind("click touchend",k),o.settings.nextSelector&&t(o.settings.nextSelector).append(o.controls.next),o.settings.prevSelector&&t(o.settings.prevSelector).append(o.controls.prev),o.settings.nextSelector||o.settings.prevSelector||(o.controls.directionEl=t('<div class="bx-controls-direction" />'),o.controls.directionEl.append(o.controls.prev).append(o.controls.next),o.controls.el.addClass("bx-has-controls-direction").append(o.controls.directionEl))},$=function(){o.controls.start=t('<div class="bx-controls-auto-item"><a class="bx-start" href="">'+o.settings.startText+"</a></div>"),o.controls.stop=t('<div class="bx-controls-auto-item"><a class="bx-stop" href="">'+o.settings.stopText+"</a></div>"),o.controls.autoEl=t('<div class="bx-controls-auto" />'),o.controls.autoEl.on("click",".bx-start",T),o.controls.autoEl.on("click",".bx-stop",E),o.settings.autoControlsCombine?o.controls.autoEl.append(o.controls.start):o.controls.autoEl.append(o.controls.start).append(o.controls.stop),o.settings.autoControlsSelector?t(o.settings.autoControlsSelector).html(o.controls.autoEl):o.controls.el.addClass("bx-has-controls-auto").append(o.controls.autoEl),P(o.settings.autoStart?"stop":"start")},C=function(){o.children.each(function(){var e=t(this).find("img:first").attr("title");void 0!==e&&(""+e).length&&t(this).append('<div class="bx-caption"><span>'+e+"</span></div>")})},S=function(t){t.preventDefault(),o.controls.el.hasClass("disabled")||(o.settings.auto&&o.settings.stopAutoOnClick&&s.stopAuto(),s.goToNextSlide())},k=function(t){t.preventDefault(),o.controls.el.hasClass("disabled")||(o.settings.auto&&o.settings.stopAutoOnClick&&s.stopAuto(),s.goToPrevSlide())},T=function(t){s.startAuto(),t.preventDefault()},E=function(t){s.stopAuto(),t.preventDefault()},j=function(e){var i,n;e.preventDefault(),o.controls.el.hasClass("disabled")||(o.settings.auto&&o.settings.stopAutoOnClick&&s.stopAuto(),i=t(e.currentTarget),void 0!==i.attr("data-slide-index")&&(n=parseInt(i.attr("data-slide-index")),n!==o.active.index&&s.goToSlide(n)))},A=function(e){var i=o.children.length;return"short"===o.settings.pagerType?(o.settings.maxSlides>1&&(i=Math.ceil(o.children.length/o.settings.maxSlides)),void o.pagerEl.html(e+1+o.settings.pagerShortSeparator+i)):(o.pagerEl.find("a").removeClass("active"),void o.pagerEl.each(function(i,n){t(n).find("a").eq(e).addClass("active")}))},I=function(){if(o.settings.infiniteLoop){var t="";0===o.active.index?t=o.children.eq(0).position():o.active.index===m()-1&&o.carousel?t=o.children.eq((m()-1)*v()).position():o.active.index===o.children.length-1&&(t=o.children.eq(o.children.length-1).position()),t&&("horizontal"===o.settings.mode?_(-t.left,"reset",0):"vertical"===o.settings.mode&&_(-t.top,"reset",0))}o.working=!1,o.settings.onSlideAfter.call(s,o.children.eq(o.active.index),o.oldIndex,o.active.index)},P=function(t){o.settings.autoControlsCombine?o.controls.autoEl.html(o.controls[t]):(o.controls.autoEl.find("a").removeClass("active"),o.controls.autoEl.find("a:not(.bx-"+t+")").addClass("active"))},D=function(){1===m()?(o.controls.prev.addClass("disabled"),o.controls.next.addClass("disabled")):!o.settings.infiniteLoop&&o.settings.hideControlOnEnd&&(0===o.active.index?(o.controls.prev.addClass("disabled"),o.controls.next.removeClass("disabled")):o.active.index===m()-1?(o.controls.next.addClass("disabled"),o.controls.prev.removeClass("disabled")):(o.controls.prev.removeClass("disabled"),o.controls.next.removeClass("disabled")))},O=function(){if(o.settings.autoDelay>0){setTimeout(s.startAuto,o.settings.autoDelay)}else s.startAuto(),t(window).focus(function(){s.startAuto()}).blur(function(){s.stopAuto()});o.settings.autoHover&&s.hover(function(){o.interval&&(s.stopAuto(!0),o.autoPaused=!0)},function(){o.autoPaused&&(s.startAuto(!0),o.autoPaused=null)})},M=function(){var e,i,n,a,r,l,d,c,p=0;"next"===o.settings.autoDirection?s.append(o.children.clone().addClass("bx-clone")):(s.prepend(o.children.clone().addClass("bx-clone")),e=o.children.first().position(),p="horizontal"===o.settings.mode?-e.left:-e.top),_(p,"reset",0),o.settings.pager=!1,o.settings.controls=!1,o.settings.autoControls=!1,o.settings.tickerHover&&(o.usingCSS?(a="horizontal"===o.settings.mode?4:5,o.viewport.hover(function(){i=s.css("-"+o.cssPrefix+"-transform"),n=parseFloat(i.split(",")[a]),_(n,"reset",0)},function(){c=0,o.children.each(function(){c+="horizontal"===o.settings.mode?t(this).outerWidth(!0):t(this).outerHeight(!0)}),r=o.settings.speed/c,l="horizontal"===o.settings.mode?"left":"top",d=r*(c-Math.abs(parseInt(n))),z(d)})):o.viewport.hover(function(){s.stop()},function(){c=0,o.children.each(function(){c+="horizontal"===o.settings.mode?t(this).outerWidth(!0):t(this).outerHeight(!0)}),r=o.settings.speed/c,l="horizontal"===o.settings.mode?"left":"top",d=r*(c-Math.abs(parseInt(s.css(l)))),z(d)})),z()},z=function(t){var e,i,n,a=t?t:o.settings.speed,r={left:0,top:0},l={left:0,top:0};"next"===o.settings.autoDirection?r=s.find(".bx-clone").first().position():l=o.children.first().position(),e="horizontal"===o.settings.mode?-r.left:-r.top,i="horizontal"===o.settings.mode?-l.left:-l.top,n={resetValue:i},_(e,"ticker",a,n)},L=function(e){var i=t(window),n={top:i.scrollTop(),left:i.scrollLeft()},o=e.offset();return n.right=n.left+i.width(),n.bottom=n.top+i.height(),o.right=o.left+e.outerWidth(),o.bottom=o.top+e.outerHeight(),!(n.right<o.left||n.left>o.right||n.bottom<o.top||n.top>o.bottom)},q=function(t){var e=document.activeElement.tagName.toLowerCase(),i="input|textarea",n=new RegExp(e,["i"]),o=n.exec(i);if(null==o&&L(s)){if(39===t.keyCode)return S(t),!1;if(37===t.keyCode)return k(t),!1}},N=function(){("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)&&(o.touch={start:{x:0,y:0},end:{x:0,y:0}},o.viewport.bind("touchstart MSPointerDown pointerdown",R),o.viewport.on("click",".bxslider a",function(t){o.viewport.hasClass("click-disabled")&&(t.preventDefault(),o.viewport.removeClass("click-disabled"))}))},R=function(t){if(t.originalEvent instanceof PointerEvent&&(!t.originalEvent||"mouse"!==t.originalEvent.pointerType))if(o.controls.el.addClass("disabled"),o.working)t.preventDefault(),o.controls.el.removeClass("disabled");else{o.touch.originalPos=s.position();var e=t.originalEvent,i="undefined"!=typeof e.changedTouches?e.changedTouches:[e];o.touch.start.x=i[0].pageX,o.touch.start.y=i[0].pageY,o.viewport.get(0).setPointerCapture&&(o.pointerId=e.pointerId,o.viewport.get(0).setPointerCapture(o.pointerId)),o.viewport.bind("touchmove MSPointerMove pointermove",H),o.viewport.bind("touchend MSPointerUp pointerup",U),o.viewport.bind("MSPointerCancel pointercancel",B)}},B=function(){_(o.touch.originalPos.left,"reset",0),o.controls.el.removeClass("disabled"),o.viewport.unbind("MSPointerCancel pointercancel",B),o.viewport.unbind("touchmove MSPointerMove pointermove",H),o.viewport.unbind("touchend MSPointerUp pointerup",U),o.viewport.get(0).releasePointerCapture&&o.viewport.get(0).releasePointerCapture(o.pointerId)},H=function(t){var e=t.originalEvent,i="undefined"!=typeof e.changedTouches?e.changedTouches:[e],n=Math.abs(i[0].pageX-o.touch.start.x),s=Math.abs(i[0].pageY-o.touch.start.y),a=0,r=0;3*n>s&&o.settings.preventDefaultSwipeX?t.preventDefault():3*s>n&&o.settings.preventDefaultSwipeY&&t.preventDefault(),"fade"!==o.settings.mode&&o.settings.oneToOneTouch&&("horizontal"===o.settings.mode?(r=i[0].pageX-o.touch.start.x,a=o.touch.originalPos.left+r):(r=i[0].pageY-o.touch.start.y,a=o.touch.originalPos.top+r),_(a,"reset",0))},U=function(t){o.viewport.unbind("touchmove MSPointerMove pointermove",H),o.controls.el.removeClass("disabled");var e=t.originalEvent,i="undefined"!=typeof e.changedTouches?e.changedTouches:[e],n=0,a=0;o.touch.end.x=i[0].pageX,o.touch.end.y=i[0].pageY,"fade"===o.settings.mode?(a=Math.abs(o.touch.start.x-o.touch.end.x),a>=o.settings.swipeThreshold&&(o.touch.start.x>o.touch.end.x?s.goToNextSlide():s.goToPrevSlide(),s.stopAuto())):("horizontal"===o.settings.mode?(a=o.touch.end.x-o.touch.start.x,n=o.touch.originalPos.left):(a=o.touch.end.y-o.touch.start.y,n=o.touch.originalPos.top),!o.settings.infiniteLoop&&(0===o.active.index&&a>0||o.active.last&&0>a)?_(n,"reset",200):Math.abs(a)>=o.settings.swipeThreshold?(0>a?s.goToNextSlide():s.goToPrevSlide(),s.stopAuto()):_(n,"reset",200)),o.viewport.unbind("touchend MSPointerUp pointerup",U),o.viewport.get(0).releasePointerCapture&&o.viewport.get(0).releasePointerCapture(o.pointerId)},W=function(){if(o.initialized)if(o.working)window.setTimeout(W,10);else{var e=t(window).width(),i=t(window).height();(a!==e||r!==i)&&(a=e,r=i,s.redrawSlider(),o.settings.onSliderResize.call(s,o.active.index))}},F=function(t){var e=g();o.settings.ariaHidden&&!o.settings.ticker&&(o.children.attr("aria-hidden","true"),o.children.slice(t,t+e).attr("aria-hidden","false"))},V=function(t){return 0>t?o.settings.infiniteLoop?m()-1:o.active.index:t>=m()?o.settings.infiniteLoop?0:o.active.index:t};return s.goToSlide=function(e,i){var n,a,r,l,d=!0,c=0,p={left:0,top:0},u=null;if(o.oldIndex=o.active.index,o.active.index=V(e),!o.working&&o.active.index!==o.oldIndex){if(o.working=!0,d=o.settings.onSlideBefore.call(s,o.children.eq(o.active.index),o.oldIndex,o.active.index),"undefined"!=typeof d&&!d)return o.active.index=o.oldIndex,void(o.working=!1);"next"===i?o.settings.onSlideNext.call(s,o.children.eq(o.active.index),o.oldIndex,o.active.index)||(d=!1):"prev"===i&&(o.settings.onSlidePrev.call(s,o.children.eq(o.active.index),o.oldIndex,o.active.index)||(d=!1)),o.active.last=o.active.index>=m()-1,(o.settings.pager||o.settings.pagerCustom)&&A(o.active.index),o.settings.controls&&D(),"fade"===o.settings.mode?(o.settings.adaptiveHeight&&o.viewport.height()!==h()&&o.viewport.animate({height:h()},o.settings.adaptiveHeightSpeed),o.children.filter(":visible").fadeOut(o.settings.speed).css({zIndex:0}),o.children.eq(o.active.index).css("zIndex",o.settings.slideZIndex+1).fadeIn(o.settings.speed,function(){t(this).css("zIndex",o.settings.slideZIndex),I()})):(o.settings.adaptiveHeight&&o.viewport.height()!==h()&&o.viewport.animate({height:h()},o.settings.adaptiveHeightSpeed),!o.settings.infiniteLoop&&o.carousel&&o.active.last?"horizontal"===o.settings.mode?(u=o.children.eq(o.children.length-1),p=u.position(),c=o.viewport.width()-u.outerWidth()):(n=o.children.length-o.settings.minSlides,p=o.children.eq(n).position()):o.carousel&&o.active.last&&"prev"===i?(a=1===o.settings.moveSlides?o.settings.maxSlides-v():(m()-1)*v()-(o.children.length-o.settings.maxSlides),u=s.children(".bx-clone").eq(a),p=u.position()):"next"===i&&0===o.active.index?(p=s.find("> .bx-clone").eq(o.settings.maxSlides).position(),o.active.last=!1):e>=0&&(l=e*parseInt(v()),p=o.children.eq(l).position()),"undefined"!=typeof p?(r="horizontal"===o.settings.mode?-(p.left-c):-p.top,_(r,"slide",o.settings.speed)):o.working=!1),o.settings.ariaHidden&&F(o.active.index*v())}},s.goToNextSlide=function(){if(o.settings.infiniteLoop||!o.active.last){var t=parseInt(o.active.index)+1;s.goToSlide(t,"next")}},s.goToPrevSlide=function(){if(o.settings.infiniteLoop||0!==o.active.index){var t=parseInt(o.active.index)-1;s.goToSlide(t,"prev")}},s.startAuto=function(t){o.interval||(o.interval=setInterval(function(){"next"===o.settings.autoDirection?s.goToNextSlide():s.goToPrevSlide()},o.settings.pause),o.settings.autoControls&&t!==!0&&P("stop"))},s.stopAuto=function(t){o.interval&&(clearInterval(o.interval),o.interval=null,o.settings.autoControls&&t!==!0&&P("start"))},s.getCurrentSlide=function(){return o.active.index},s.getCurrentSlideElement=function(){return o.children.eq(o.active.index)},s.getSlideElement=function(t){return o.children.eq(t)},s.getSlideCount=function(){return o.children.length},s.isWorking=function(){return o.working},s.redrawSlider=function(){o.children.add(s.find(".bx-clone")).outerWidth(f()),o.viewport.css("height",h()),o.settings.ticker||b(),o.active.last&&(o.active.index=m()-1),o.active.index>=m()&&(o.active.last=!0),o.settings.pager&&!o.settings.pagerCustom&&(w(),A(o.active.index)),o.settings.ariaHidden&&F(o.active.index*v())},s.destroySlider=function(){o.initialized&&(o.initialized=!1,t(".bx-clone",this).remove(),o.children.each(function(){void 0!==t(this).data("origStyle")?t(this).attr("style",t(this).data("origStyle")):t(this).removeAttr("style")}),void 0!==t(this).data("origStyle")?this.attr("style",t(this).data("origStyle")):t(this).removeAttr("style"),t(this).unwrap().unwrap(),o.controls.el&&o.controls.el.remove(),o.controls.next&&o.controls.next.remove(),o.controls.prev&&o.controls.prev.remove(),o.pagerEl&&o.settings.controls&&!o.settings.pagerCustom&&o.pagerEl.remove(),t(".bx-caption",this).remove(),o.controls.autoEl&&o.controls.autoEl.remove(),clearInterval(o.interval),o.settings.responsive&&t(window).unbind("resize",W),o.settings.keyboardEnabled&&t(document).unbind("keydown",q),t(this).removeData("bxSlider"))},s.reloadSlider=function(e){void 0!==e&&(n=e),s.destroySlider(),l(),t(s).data("bxSlider",this)},l(),t(s).data("bxSlider",this),this}}}(jQuery);var BCSlider=function(t,e){function i(){var e=t(this),i=e.parents(".bx-wrapper");n(i),a.resize(n.bind(this,i));var s=e.find(d).parents(".no_slider");s.removeClass(".no_slider"),h(null,e),o(this)}function n(t){t.children(".bx-pager").length>0&&t.children(".bx-pager").detach().appendTo(t.find(".bx-viewport"))}function o(e){t(d).each(function(){var e=t(this),i=e.parent().find("img.jacketCover");1===i.height()?e.parents(".carousel_item").addClass("no_image"):e.css("height",i.height())}),e.redrawSlider()}function s(e,i){var n=t.Deferred(),o=function(){var t=e.find("div.carousel_item"),o=Math.floor(0===t.length?0:e.width()/(i.slideWidth+i.slideMargin));0===t.length||o>t.length?(h(null,e),t.addClass("no_slider"),t.width(i.slideWidth)):(t.removeClass("no_slider"),n.resolve())};return a.on("resize.bc.carousel",o),o(),n.promise()}var a=t(e),r=e.BCSlider,l="function"==typeof e.bc_datajs_selector,d=".hover_overlay";l&&(d=bc_datajs_selector("resize_hover_overlay"));var c=function(){var t=e.BCSlider;return e.BCSlider=r,t},p={slideSelector:"div.carousel_item",slideMargin:20,minSlides:1,maxSlides:15,slideWidth:120,prevText:'<i class="icon-angle-left"></i>',nextText:'<i class="icon-angle-right"></i>',onSliderLoad:i},h=function(){function e(t){return t.attr("src")&&t.attr("src").indexOf("/assets/default_covers")>=0}function i(t,e){return t.attr("src")!==t.attr("fallback")&&e.width<=1||e.height<=1}function n(e,i){var n=Math.max.apply(Math,i.find("div.carousel_item").map(function(){return t(this).outerHeight(!1)}).get());180>n?e.parents(".carousel_item").addClass("no_image").css("height",n+"px"):e.parents(".carousel_item").addClass("no_image"),e.trigger("load")}return function(o,s){s.each(function(){t(this).find(".carousel_item").each(function(){var o=t(this).find("img");if(o.length>0){var a=new Image;a.onerror=function(){n(o,s)},a.onload=function(){(e(o)||i(o,a))&&n(o,s)},a.src=o.attr("src")}})})}}();return t.fn.bcSlider=function(e){return"object"!=typeof e&&(e={}),this.length>0&&t.fn.bxSlider.call(this,t.extend(!0,{},BCSlider.defaultCarouselOptions,e)),this},{defaultCarouselOptions:p,carouselImageCheck:h,carouselHasEnoughSlides:s,resizeHoverOverlay:o,onSliderLoad:i,fixCarouselPagination:n,noConflict:c}}(jQuery,this);